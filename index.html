<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quick Receivables SIT Test Plan & Scripts</title>
    <script type="module">
        // Firebase SDK imports
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        // Corrected import: added getDocs
        import { getFirestore, doc, setDoc, onSnapshot, collection, query, deleteDoc, getDocs } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Global Firebase instances and user ID
        let app;
        let db;
        let auth;
        let userId;
        let isAuthReady = false; // Flag to ensure auth is ready before Firestore operations

        // Global object to store test data and daily progress
        let testData = {};
        let dailyProgress = {};

        // Define all expected test IDs with default pending status
        const allTestIds = [
            'SIT-SAP-001', 'SIT-SAP-002', 'SIT-SAP-003', 'SIT-SAP-004', 'SIT-SAP-005',
            'SIT-MC-001', 'SIT-MC-002', 'SIT-MC-003', 'SIT-MC-004', 'SIT-MC-005',
            'SIT-DUN-001', 'SIT-DUN-002', 'SIT-DUN-003', 'SIT-DUN-004', 'SIT-DUN-005',
            'SIT-DL-001', 'SIT-DL-002', 'SIT-DL-003', 'SIT-DL-004'
        ];

        document.addEventListener('DOMContentLoaded', async () => {
            // Initialize testData with all IDs and default status
            allTestIds.forEach(id => {
                testData[id] = { status: 'pending' };
            });
            
            // Initialize Firebase
            try {
                // Use global variables provided by the Canvas environment
                const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
                const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};

                app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);

                // Authenticate user
                if (typeof __initial_auth_token !== 'undefined') {
                    await signInWithCustomToken(auth, __initial_auth_token);
                } else {
                    await signInAnonymously(auth);
                }

                // Listen for auth state changes
                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        userId = user.uid;
                        document.getElementById('user-id-display').textContent = `User ID: ${userId}`;
                        isAuthReady = true;
                        console.log("Firebase authenticated. User ID:", userId);
                        
                        // Load data from Firestore after authentication is ready
                        loadTestDataFromFirestore();
                        loadDailyProgressFromFirestore();
                        initializeTabFunctionality();
                        attachInputListeners(); // Attach listeners after loading data
                        attachDailyInputListeners(); // Attach listeners for daily inputs
                    } else {
                        console.log("No user signed in.");
                        userId = null;
                        document.getElementById('user-id-display').textContent = 'User ID: N/A (Sign in required)';
                        isAuthReady = false;
                        // If not authenticated, ensure UI reflects default pending state
                        updateOverallSummary(); 
                    }
                });

            } catch (error) {
                console.error("Error initializing Firebase or signing in:", error);
                document.getElementById('user-id-display').textContent = 'Error initializing Firebase.';
                updateOverallSummary(); // Update summary even if Firebase init fails
            }
        });

        /**
         * Initializes the tab functionality by setting the active tab based on saved state
         * or defaulting to the 'overview' tab.
         */
        window.initializeTabFunctionality = function() {
            const tabs = document.querySelectorAll('.nav-tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            // Get last active tab from localStorage or default to 'overview'
            const lastActiveTabId = localStorage.getItem('activeTabId') || 'overview';
            
            // Deactivate all tabs and hide all tab contents initially
            tabs.forEach(tab => tab.classList.remove('active'));
            tabContents.forEach(content => content.classList.remove('active'));

            // Activate the last active tab and show its content
            const activeTabButton = document.querySelector(`.nav-tab[onclick*="${lastActiveTabId}"]`);
            const activeTabContent = document.getElementById(lastActiveTabId);

            if (activeTabButton && activeTabContent) {
                activeTabButton.classList.add('active');
                activeTabContent.classList.add('active');
            } else {
                // Fallback to overview if stored tab is not found
                document.querySelector('.nav-tab').classList.add('active');
                document.getElementById('overview').classList.add('active');
                localStorage.setItem('activeTabId', 'overview');
            }
        }

        /**
         * Switches the active tab and displays the corresponding content.
         * @param {string} tabId - The ID of the tab content to display.
         * @param {HTMLElement} clickedButton - The button element that was clicked.
         */
        window.switchTab = function(tabId, clickedButton) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });

            // Deactivate all tab buttons
            document.querySelectorAll('.nav-tab').forEach(button => {
                button.classList.remove('active');
            });

            // Show the selected tab content
            document.getElementById(tabId).classList.add('active');

            // Activate the clicked tab button
            clickedButton.classList.add('active');

            // Save the active tab ID to localStorage
            localStorage.setItem('activeTabId', tabId);
        }

        /**
         * Updates the status of a specific test case and saves progress to Firestore.
         * @param {string} testId - The ID of the test case (e.g., 'SIT-SAP-001').
         * @param {string} status - The new status ('pending', 'passed', 'failed', 'blocked', 'na').
         */
        window.updateTestStatus = async function(testId, status) {
            if (!isAuthReady) {
                console.warn("Firestore not ready. Cannot update test status.");
                return;
            }
            if (!testData[testId]) {
                testData[testId] = {};
            }
            testData[testId].status = status;
            await saveTestDataToFirestore(testId, testData[testId]);
            updateOverallSummary();
        }

        /**
         * Attaches event listeners to all input and select elements within test result sections
         * to automatically save their values to Firestore.
         */
        window.attachInputListeners = function() {
            document.querySelectorAll('.test-results-section [data-testid]').forEach(input => {
                input.addEventListener('change', async (event) => {
                    if (!isAuthReady) {
                        console.warn("Firestore not ready. Cannot save input data.");
                        return;
                    }
                    const testId = input.dataset.testid;
                    const field = input.dataset.field;
                    if (!testData[testId]) {
                        testData[testId] = {};
                    }
                    testData[testId][field] = event.target.value;
                    await saveTestDataToFirestore(testId, testData[testId]);
                });
            });
        }

        /**
         * Attaches event listeners to daily progress input fields.
         */
        window.attachDailyInputListeners = function() {
            document.querySelectorAll('.daily-executed, .daily-passed, .daily-failed, .daily-notes').forEach(input => {
                input.addEventListener('change', async (event) => {
                    if (!isAuthReady) {
                        console.warn("Firestore not ready. Cannot save daily progress.");
                        return;
                    }
                    const date = input.dataset.date;
                    const className = input.className; // e.g., 'daily-executed'
                    
                    if (!dailyProgress[date]) {
                        dailyProgress[date] = {};
                    }
                    dailyProgress[date][className] = event.target.value;
                    await saveDailyProgressToFirestore(date, dailyProgress[date]);
                    updateOverallSummary(); // Update summary when daily inputs change
                });
            });
        }

        /**
         * Updates the values of daily progress input fields from the `dailyProgress` object.
         * This is called on page load after loading from Firestore.
         */
        window.updateDailyProgressInputs = function() {
            document.querySelectorAll('.daily-executed, .daily-passed, .daily-failed, .daily-notes').forEach(input => {
                const date = input.dataset.date;
                const className = input.className;
                if (dailyProgress[date] && dailyProgress[date][className] !== undefined) {
                    input.value = dailyProgress[date][className];
                }
            });
        }

        /**
         * Saves a single test case's data to Firestore.
         * @param {string} testId - The ID of the test case.
         * @param {object} data - The data object for the test case.
         */
        async function saveTestDataToFirestore(testId, data) {
            if (!isAuthReady || !userId) {
                console.warn("Firestore not ready or user not authenticated. Cannot save test data.");
                return;
            }
            try {
                const docRef = doc(db, `artifacts/${__app_id}/users/${userId}/testResults`, testId);
                await setDoc(docRef, data, { merge: true });
                console.log(`Test data for ${testId} saved to Firestore.`);
            } catch (e) {
                console.error("Error saving test data to Firestore:", e);
            }
        }

        /**
         * Saves daily progress data to Firestore.
         * @param {string} date - The date for the daily progress.
         * @param {object} data - The data object for the daily progress.
         */
        async function saveDailyProgressToFirestore(date, data) {
            if (!isAuthReady || !userId) {
                console.warn("Firestore not ready or user not authenticated. Cannot save daily progress.");
                return;
            }
            try {
                const docRef = doc(db, `artifacts/${__app_id}/users/${userId}/dailyProgress`, date);
                await setDoc(docRef, data, { merge: true });
                console.log(`Daily progress for ${date} saved to Firestore.`);
            } catch (e) {
                console.error("Error saving daily progress to Firestore:", e);
            }
        }

        /**
         * Loads all test data from Firestore and sets up a real-time listener.
         */
        function loadTestDataFromFirestore() {
            if (!isAuthReady || !userId) {
                console.warn("Firestore not ready or user not authenticated. Cannot load test data.");
                return;
            }
            const testResultsColRef = collection(db, `artifacts/${__app_id}/users/${userId}/testResults`);
            onSnapshot(testResultsColRef, (snapshot) => {
                // Start with a fresh copy of allTestIds with default pending status
                const newTestData = {};
                allTestIds.forEach(id => {
                    newTestData[id] = { status: 'pending' };
                });

                // Overlay loaded data from Firestore
                snapshot.forEach(doc => {
                    newTestData[doc.id] = { ...newTestData[doc.id], ...doc.data() }; // Merge existing defaults with loaded data
                });
                testData = newTestData; // Update the global testData object
                
                console.log("Test data loaded/updated from Firestore:", testData);
                // Populate UI with loaded data
                document.querySelectorAll('.test-results-section [data-testid]').forEach(input => {
                    const testId = input.dataset.testid;
                    const field = input.dataset.field;
                    if (testData[testId] && testData[testId][field] !== undefined) {
                        input.value = testData[testId][field];
                    }
                });
                document.querySelectorAll('.status-dropdown').forEach(select => {
                    const testIdMatch = select.onchange.toString().match(/'(SIT-[A-Z]{2,3}-\d{3})'/);
                    if (testIdMatch && testData[testIdMatch[1]] && testData[testIdMatch[1]].status) {
                        select.value = testData[testIdMatch[1]].status;
                    }
                });
                updateOverallSummary();
            }, (error) => {
                console.error("Error listening to test data:", error);
            });
        }

        /**
         * Loads daily progress data from Firestore and sets up a real-time listener.
         */
        function loadDailyProgressFromFirestore() {
            if (!isAuthReady || !userId) {
                console.warn("Firestore not ready or user not authenticated. Cannot load daily progress.");
                return;
            }
            const dailyProgressColRef = collection(db, `artifacts/${__app_id}/users/${userId}/dailyProgress`);
            onSnapshot(dailyProgressColRef, (snapshot) => {
                dailyProgress = {}; // Clear existing data
                snapshot.forEach(doc => {
                    dailyProgress[doc.id] = doc.data();
                });
                console.log("Daily progress loaded/updated from Firestore:", dailyProgress);
                updateDailyProgressInputs();
                updateOverallSummary();
            }, (error) => {
                console.error("Error listening to daily progress:", error);
            });
        }

        /**
         * Saves the current progress (manual trigger for user).
         */
        window.saveProgress = async function() {
            // Data is already being saved on input change via Firestore listeners.
            // This button can serve as a confirmation or a forced sync if needed,
            // but the auto-save to Firestore on change makes it less critical.
            console.log("Save Progress button clicked. Data is auto-saved to Firestore on input change.");
            // Optionally, you could add a visual confirmation here.
        }

        /**
         * Clears all saved data from Firestore and resets the UI.
         */
        window.clearAllData = async function() {
            if (!isAuthReady || !userId) {
                showMessageBox("Cannot clear data: Firestore not ready or user not authenticated.");
                return;
            }

            // Confirm with the user
            const confirmClear = await new Promise(resolve => {
                const modal = document.createElement('div');
                modal.style.cssText = `
                    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                    background: rgba(0,0,0,0.6); display: flex; justify-content: center; align-items: center;
                    z-index: 9999;
                `;
                const content = document.createElement('div');
                content.style.cssText = `
                    background: white; padding: 25px; border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                    text-align: center; max-width: 400px; width: 90%;
                `;
                const p = document.createElement('p');
                p.textContent = "Are you sure you want to clear ALL saved test data and daily progress? This action cannot be undone.";
                p.style.marginBottom = '20px';
                const buttonContainer = document.createElement('div');
                buttonContainer.style.display = 'flex';
                buttonContainer.style.justifyContent = 'center';
                buttonContainer.style.gap = '10px';

                const confirmBtn = document.createElement('button');
                confirmBtn.textContent = 'Yes, Clear All';
                confirmBtn.style.cssText = `
                    padding: 10px 20px; background: #dc3545; color: white; border: none; border-radius: 5px;
                    cursor: pointer; font-size: 14px;
                `;
                confirmBtn.onclick = () => { document.body.removeChild(modal); resolve(true); };

                const cancelBtn = document.createElement('button');
                cancelBtn.textContent = 'Cancel';
                cancelBtn.style.cssText = `
                    padding: 10px 20px; background: #6c757d; color: white; border: none; border-radius: 5px;
                    cursor: pointer; font-size: 14px;
                `;
                cancelBtn.onclick = () => { document.body.removeChild(modal); resolve(false); };

                buttonContainer.appendChild(confirmBtn);
                buttonContainer.appendChild(cancelBtn);
                content.appendChild(p);
                content.appendChild(buttonContainer);
                modal.appendChild(content);
                document.body.appendChild(modal);
            });

            if (!confirmClear) {
                return; // User cancelled
            }

            try {
                // Delete all test data documents
                const testResultsQuery = collection(db, `artifacts/${__app_id}/users/${userId}/testResults`);
                const testResultsSnapshot = await getDocs(testResultsQuery);
                const deleteTestPromises = [];
                testResultsSnapshot.forEach(doc => {
                    deleteTestPromises.push(deleteDoc(doc.ref));
                });
                await Promise.all(deleteTestPromises);

                // Delete all daily progress documents
                const dailyProgressQuery = collection(db, `artifacts/${__app_id}/users/${userId}/dailyProgress`);
                const dailyProgressSnapshot = await getDocs(dailyProgressQuery);
                const deleteDailyPromises = [];
                dailyProgressSnapshot.forEach(doc => {
                    deleteDailyPromises.push(deleteDoc(doc.ref));
                });
                await Promise.all(deleteDailyPromises);

                // Reset local data and UI
                allTestIds.forEach(id => {
                    testData[id] = { status: 'pending' }; // Reset to default pending
                });
                dailyProgress = {};
                
                // Clear all input fields in the UI
                document.querySelectorAll('.test-results-section [data-testid]').forEach(input => {
                    if (input.tagName === 'SELECT') {
                        input.value = 'pending'; // Reset dropdowns
                    } else {
                        input.value = ''; // Clear text/number inputs
                    }
                });
                document.querySelectorAll('.daily-executed, .daily-passed, .daily-failed').forEach(input => input.value = '0');
                document.querySelectorAll('.daily-notes').forEach(input => input.value = '');

                updateOverallSummary();
                showMessageBox("All data cleared successfully!");
            } catch (e) {
                console.error("Error clearing data from Firestore:", e);
                showMessageBox("Error clearing data. Please check console for details.");
            }
        }

        /**
         * Updates the overall summary statistics and category progress.
         */
        window.updateOverallSummary = function() {
            let totalPassed = 0;
            let totalFailed = 0;
            let totalBlocked = 0;
            let totalPending = 0;
            let totalTestsCounted = 0; // Only count tests that are not N/A for coverage

            // Define which test IDs belong to the 'Error Handling' category
            const ehTestIds = ['SIT-SAP-005', 'SIT-DUN-005', 'SIT-DL-003'];

            const categoryStats = {
                'SAP': { total: 5, passed: 0, failed: 0, blocked: 0, pending: 0 },
                'MC': { total: 5, passed: 0, failed: 0, blocked: 0, pending: 0 },
                'DUN': { total: 5, passed: 0, failed: 0, blocked: 0, pending: 0 },
                'DL': { total: 4, passed: 0, failed: 0, blocked: 0, pending: 0 },
                'EH': { total: ehTestIds.length, passed: 0, failed: 0, blocked: 0, pending: 0 } // Total for EH is based on defined EH tests
            };

            // Iterate through the allTestIds to ensure all are considered
            allTestIds.forEach(testId => {
                const status = testData[testId] && testData[testId].status ? testData[testId].status : 'pending'; // Default to pending

                // Update counts for primary categories (SAP, MC, DUN, DL)
                const categoryPrefix = testId.substring(4, testId.indexOf('-', 4));
                const categoryKey = Object.keys(categoryStats).find(key => testId.includes(key) && key !== 'EH');

                if (categoryKey) {
                    switch (status) {
                        case 'passed':
                            categoryStats[categoryKey].passed++;
                            break;
                        case 'failed':
                            categoryStats[categoryKey].failed++;
                            break;
                        case 'blocked':
                            categoryStats[categoryKey].blocked++;
                            break;
                        case 'pending':
                            categoryStats[categoryKey].pending++;
                            break;
                    }
                }

                // Update counts for Error Handling category specifically
                if (ehTestIds.includes(testId)) {
                    switch (status) {
                        case 'passed':
                            categoryStats['EH'].passed++;
                            break;
                        case 'failed':
                            categoryStats['EH'].failed++;
                            break;
                        case 'blocked':
                            categoryStats['EH'].blocked++;
                            break;
                        case 'pending':
                            categoryStats['EH'].pending++;
                            break;
                    }
                }

                // Update overall totals (each test counted once for overall summary)
                if (status !== 'na') { // Only count non-N/A tests for overall totals
                    totalTestsCounted++;
                    switch (status) {
                        case 'passed':
                            totalPassed++;
                            break;
                        case 'failed':
                            totalFailed++;
                            break;
                        case 'blocked':
                            totalBlocked++;
                            break;
                        case 'pending':
                            totalPending++;
                            break;
                    }
                }
            });

            // Update overall summary stats
            document.getElementById('stat-passed').textContent = totalPassed;
            document.getElementById('stat-failed').textContent = totalFailed;
            document.getElementById('stat-blocked').textContent = totalBlocked;
            document.getElementById('stat-pending').textContent = totalPending;
            document.getElementById('stat-total').textContent = totalTestsCounted; // Total tests that are not N/A
            
            const coverage = totalTestsCounted > 0 ? ((totalPassed / totalTestsCounted) * 100).toFixed(1) : 0;
            document.getElementById('stat-coverage').textContent = `${coverage}%`;

            // Update category-specific stats
            for (const key in categoryStats) {
                if (categoryStats.hasOwnProperty(key)) {
                    const stats = categoryStats[key];
                    document.getElementById(`${key.toLowerCase()}-passed`).textContent = stats.passed;
                    document.getElementById(`${key.toLowerCase()}-failed`).textContent = stats.failed;
                    document.getElementById(`${key.toLowerCase()}-blocked`).textContent = stats.blocked;
                    document.getElementById(`${key.toLowerCase()}-pending`).textContent = stats.pending;
                    
                    const categoryTotal = stats.total;
                    const categoryExecuted = stats.passed + stats.failed + stats.blocked;
                    const categoryProgress = categoryTotal > 0 ? ((categoryExecuted / categoryTotal) * 100).toFixed(1) : 0;
                    document.getElementById(`${key.toLowerCase()}-progress`).textContent = `${categoryProgress}%`;
                }
            }
        }

        let selectedExportFormat = '';

        /**
         * Shows the export format selection modal.
         */
        window.showExportModal = function() {
            document.getElementById('exportFormatModal').style.display = 'flex';
        }

        /**
         * Closes the export format selection modal.
         */
        window.closeExportModal = function() {
            document.getElementById('exportFormatModal').style.display = 'none';
            // Deselect any chosen format
            document.querySelectorAll('.format-option').forEach(option => {
                option.classList.remove('selected');
            });
            selectedExportFormat = '';
        }

        // Add event listeners for format options
        document.querySelectorAll('.format-option').forEach(option => {
            option.addEventListener('click', () => {
                document.querySelectorAll('.format-option').forEach(opt => opt.classList.remove('selected'));
                option.classList.add('selected');
                selectedExportFormat = option.dataset.format;
            });
        });

        /**
         * Handles the export process based on the selected format.
         */
        window.exportResults = function() {
            if (!selectedExportFormat) {
                // Using a custom message box instead of alert()
                showMessageBox('Please select an export format.');
                return;
            }

            switch (selectedExportFormat) {
                case 'csv':
                    exportToCsv();
                    break;
                default:
                    console.error('Unknown export format:', selectedExportFormat);
            }
            closeExportModal();
        }

        /**
         * Custom message box function (replaces alert()).
         * @param {string} message - The message to display.
         */
        function showMessageBox(message) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0,0,0,0.6); display: flex; justify-content: center; align-items: center;
                z-index: 9999;
            `;
            const content = document.createElement('div');
            content.style.cssText = `
                background: white; padding: 25px; border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                text-align: center; max-width: 400px; width: 90%;
            `;
            const p = document.createElement('p');
            p.textContent = message;
            p.style.marginBottom = '20px';
            const button = document.createElement('button');
            button.textContent = 'OK';
            button.style.cssText = `
                padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px;
                cursor: pointer; font-size: 16px;
            `;
            button.onclick = () => document.body.removeChild(modal);
            content.appendChild(p);
            content.appendChild(button);
            modal.appendChild(content);
            document.body.appendChild(modal);
        }

        /**
         * Exports the test data to a CSV file.
         */
        function exportToCsv() {
            let csvContent = "Test ID,Status,Executed By,Execution Date,Execution Time (minutes),Environment,Build Version,Test Notes / Comments,Defect ID,Retest Required,Priority\n";

            // Collect data from testData object
            for (const testId in testData) {
                if (testData.hasOwnProperty(testId)) {
                    const data = testData[testId];
                    // Ensure all fields are present, even if empty, to maintain column integrity
                    const row = [
                        testId,
                        data.status || '',
                        data.tester || '',
                        data.date || '',
                        data.duration || '',
                        data.environment || '',
                        data.build || '',
                        `"${(data.notes || '').replace(/"/g, '""')}"`, // Escape quotes for CSV
                        data.defect || '',
                        data.retest || '',
                        data.priority || ''
                    ].join(',');
                    csvContent += row + '\n';
                }
            }

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            if (link.download !== undefined) { // feature detection
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', 'QuickReceivables_SIT_Test_Results.csv');
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }
        }
    </script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            padding-top: 60px; /* Increased padding to make space for buttons */
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .export-controls {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }
        
        .export-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }
        
        .export-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        .user-info {
            position: absolute;
            top: 20px;
            left: 20px;
            color: rgba(255,255,255,0.7);
            font-size: 0.8em;
        }
        
        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
            overflow-x: auto;
        }
        
        .nav-tab {
            padding: 15px 20px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: #495057;
            white-space: nowrap;
            transition: all 0.3s ease;
        }
        
        .nav-tab:hover {
            background: #e9ecef;
            color: #007bff;
        }
        
        .nav-tab.active {
            background: #007bff;
            color: white;
        }
        
        .tab-content {
            display: none;
            padding: 30px;
            line-height: 1.6;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .section-header {
            font-size: 1.8em;
            color: #2c3e50;
            margin: 30px 0 20px 0;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        
        .test-overview {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
            padding: 25px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .test-overview h3 {
            margin-top: 0;
            font-size: 1.4em;
        }
        
        .test-category {
            background: #f8f9fa;
            border-left: 4px solid #28a745;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .test-category h4 {
            color: #28a745;
            margin-top: 0;
        }
        
        .table-container {
            overflow-x: auto;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        
        th {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            padding: 15px 12px;
            text-align: left;
            font-weight: 600;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        td {
            padding: 12px 8px;
            border-bottom: 1px solid #e9ecef;
            font-size: 13px;
            vertical-align: top;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        .priority-critical { background: #ffe6e6; color: #d63031; font-weight: bold; }
        .priority-high { background: #fff3cd; color: #e17055; font-weight: bold; }
        .priority-medium { background: #e8f5e8; color: #00b894; font-weight: bold; }
        
        .status-pending { background: #e3f2fd; color: #1976d2; padding: 4px 8px; border-radius: 4px; }
        .status-passed { background: #e8f5e8; color: #388e3c; padding: 4px 8px; border-radius: 4px; }
        .status-failed { background: #ffebee; color: #d32f2f; padding: 4px 8px; border-radius: 4px; }
        .status-blocked { background: #fff3e0; color: #f57c00; padding: 4px 8px; border-radius: 4px; }
        .status-na { background: #f5f5f5; color: #757575; padding: 4px 8px; border-radius: 4px; }
        
        .test-step {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .test-step h5 {
            color: #2c3e50;
            margin-top: 0;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .test-results-section {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .test-results-section h4 {
            color: #2c3e50;
            margin-top: 0;
            margin-bottom: 15px;
        }
        
        .result-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin: 15px 0;
        }
        
        .result-field {
            display: flex;
            flex-direction: column;
        }
        
        .result-field label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #495057;
            font-size: 12px;
        }
        
        .result-field input, .result-field select, .result-field textarea {
            padding: 8px 12px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }
        
        .result-field textarea {
            min-height: 60px;
            resize: vertical;
        }
        
        .status-dropdown {
            background: white;
            cursor: pointer;
        }
        
        .status-dropdown:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0,123,255,0.25);
        }
        
        .daily-executed, .daily-passed, .daily-failed {
            width: 60px !important;
            padding: 6px 8px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            text-align: center;
            font-size: 14px;
        }
        
        .daily-notes {
            width: 100% !important;
            max-width: 200px;
            padding: 6px 8px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .pre-conditions {
            background: #e8f5e8;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .test-data {
            background: #fff3cd;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .expected-result {
            background: #e3f2fd;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .timeline-item {
            background: white;
            border-left: 4px solid #3498db;
            padding: 15px 20px;
            margin: 10px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .timeline-item h4 {
            margin: 0 0 10px 0;
            color: #2c3e50;
        }
        
        .integration-flow {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        .flow-step {
            display: inline-block;
            background: #007bff;
            color: white;
            padding: 10px 15px;
            margin: 5px;
            border-radius: 5px;
            font-size: 12px;
        }
        
        .flow-arrow {
            color: #666;
            font-size: 18px;
            margin: 0 10px;
        }
        
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-number.passed { color: #28a745; }
        .stat-number.failed { color: #dc3545; }
        .stat-number.pending { color: #007bff; }
        .stat-number.blocked { color: #ffc107; }
        
        .stat-label {
            font-size: 12px;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .export-format-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 8px;
            max-width: 500px;
            width: 90%;
        }
        
        .modal-content h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        
        .format-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .format-option {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .format-option:hover {
            border-color: #007bff;
            background: #e3f2fd;
        }
        
        .format-option.selected {
            border-color: #007bff;
            background: #e3f2fd;
            color: #007bff;
        }
        
        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: #007bff;
            color: white;
        }
        
        .btn-primary:hover {
            background: #0056b3;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #545b62;
        }
        
        @media print {
            .export-controls, .nav-tabs, .user-info { display: none; }
            .container { box-shadow: none; border-radius: 0; }
            body { background: white; padding: 0; }
            .header { padding: 20px; } /* Adjust header padding for print */
        }
        
        @media (max-width: 768px) {
            .result-grid {
                grid-template-columns: 1fr;
            }
            
            .export-controls {
                position: static;
                margin-bottom: 15px;
                justify-content: center;
            }
            
            .header {
                text-align: center; /* Center header on small screens if buttons are static */
                padding-top: 30px; /* Reset padding for smaller screens */
            }
            .user-info {
                position: static;
                text-align: center;
                margin-bottom: 10px;
            }
            
            .daily-notes {
                max-width: 150px;
            }
            
            .daily-executed, .daily-passed, .daily-failed {
                width: 50px !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="user-info" id="user-id-display">User ID: N/A</div>
            <div class="export-controls">
                <button class="export-btn" onclick="showExportModal()">📊 Export Results</button>
                <button class="export-btn" onclick="window.print()">🖨️ Print</button>
                <button class="export-btn" onclick="saveProgress()">💾 Save Progress</button>
                <button class="export-btn" onclick="clearAllData()">🗑️ Clear Data</button>
            </div>
            <h1>Quick Receivables SIT Test Plan</h1>
            <p>System Integration Testing | WillScot | Aug 11-22, 2025</p>
        </div>
        
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('overview', this)">Test Overview</button>
            <button class="nav-tab" onclick="switchTab('results-summary', this)">📊 Results Summary</button>
            <button class="nav-tab" onclick="switchTab('sap-integration', this)">SAP Integration</button>
            <button class="nav-tab" onclick="switchTab('marketing-cloud', this)">Marketing Cloud</button>
            <button class="nav-tab" onclick="switchTab('dunning-automation', this)">Dunning Automation</button>
            <button class="nav-tab" onclick="switchTab('data-loader', this)">Data Loader Scripts</button>
            <button class="nav-tab" onclick="switchTab('schedule', this)">Test Schedule</button>
        </div>
        
        <!-- Test Overview Tab -->
        <div id="overview" class="tab-content active">
            <h2 class="section-header">SIT Test Plan Overview</h2>
            
            <div class="test-overview">
                <h3>🎯 SIT Testing Objectives</h3>
                <ul>
                    <li><strong>SAP to Salesforce Integration</strong> - Validate complete data flow from SAP to Quick Receivables</li>
                    <li><strong>Marketing Cloud Integration</strong> - Verify dunning email automation and tracking</li>
                    <li><strong>Data Processing Automation</strong> - Test Node.js file watcher and Data Loader CLI automation</li>
                    <li><strong>End-to-End Workflows</strong> - Validate complete AR automation processes</li>
                    <li><strong>Error Handling & Recovery</strong> - Test failure scenarios and recovery mechanisms</li>
                </ul>
            </div>
            
            <div class="timeline-item">
                <h4>📅 SIT Timeline: August 11-22, 2025</h4>
                <p><strong>Duration:</strong> 10 business days</p>
                <p><strong>Environment:</strong> WillScot Salesforce Sandbox with Quick Receivables managed package</p>
                <p><strong>Data:</strong> SAP test data extracts (ARCUST, ARMAST, ARCASH, AREXTI)</p>
            </div>
            
            <h3>Test Environment Architecture</h3>
            <div class="integration-flow">
                <span class="flow-step">SAP Test System</span>
                <span class="flow-arrow">→</span>
                <span class="flow-step">WillScot Server</span>
                <span class="flow-arrow">→</span>
                <span class="flow-step">Node.js Watcher</span>
                <span class="flow-arrow">→</span>
                <span class="flow-step">Data Loader CLI</span>
                <span class="flow-arrow">→</span>
                <span class="flow-step">Salesforce Sandbox</span>
                <span class="flow-arrow">→</span>
                <span class="flow-step">Marketing Cloud</span>
            </div>
            
            <h3>Test Categories & Coverage</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Test Category</th>
                            <th>Test Count</th>
                            <th>Priority</th>
                            <th>Dependencies</th>
                            <th>Estimated Effort</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>SAP Data Integration</strong></td>
                            <td>5 test cases</td>
                            <td><span class="priority-critical">Critical</span></td>
                            <td>SAP test data, Server access</td>
                            <td>3 days</td>
                        </tr>
                        <tr>
                            <td><strong>Marketing Cloud Integration</strong></td>
                            <td>5 test cases</td>
                            <td><span class="priority-high">High</span></td>
                            <td>MC Connect, Email templates</td>
                            <td>2 days</td>
                        </tr>
                        <tr>
                            <td><strong>Dunning Automation</strong></td>
                            <td>5 test cases</td>
                            <td><span class="priority-high">High</span></td>
                            <td>CMDT configuration, Task creation</td>
                            <td>2 days</td>
                        </tr>
                        <tr>
                            <td><strong>Data Loader Automation</strong></td>
                            <td>4 test cases</td>
                            <td><span class="priority-high">High</span></td>
                            <td>Node.js script, CLI setup</td>
                            <td>1.5 days</td>
                        </tr>
                        <tr>
                            <td><strong>Error Handling & Recovery</strong></td>
                            <td>3 test cases</td>
                            <td><span class="priority-medium">Medium</span></td>
                            <td>All integrations working</td>
                            <td>1.5 days</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Results Summary Tab -->
        <div id="results-summary" class="tab-content">
            <h2 class="section-header">Test Execution Results Summary</h2>
            
            <div class="summary-stats">
                <div class="stat-card">
                    <div class="stat-number passed" id="stat-passed">0</div>
                    <div class="stat-label">Passed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number failed" id="stat-failed">0</div>
                    <div class="stat-label">Failed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number blocked" id="stat-blocked">0</div>
                    <div class="stat-label">Blocked</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number pending" id="stat-pending">19</div>
                    <div class="stat-label">Pending</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="stat-total">19</div>
                    <div class="stat-label">Total Tests</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="stat-coverage">0%</div>
                    <div class="stat-label">Coverage</div>
                </div>
            </div>
            
            <h3>Test Execution Progress by Category</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Test Category</th>
                            <th>Total</th>
                            <th>Passed</th>
                            <th>Failed</th>
                            <th>Blocked</th>
                            <th>Pending</th>
                            <th>Progress</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>SAP Integration</strong></td>
                            <td>5</td>
                            <td id="sap-passed">0</td>
                            <td id="sap-failed">0</td>
                            <td id="sap-blocked">0</td>
                            <td id="sap-pending">5</td>
                            <td id="sap-progress">0%</td>
                        </tr>
                        <tr>
                            <td><strong>Marketing Cloud</strong></td>
                            <td>5</td>
                            <td id="mc-passed">0</td>
                            <td id="mc-failed">0</td>
                            <td id="mc-blocked">0</td>
                            <td id="mc-pending">5</td>
                            <td id="mc-progress">0%</td>
                        </tr>
                        <tr>
                            <td><strong>Dunning Automation</strong></td>
                            <td>5</td>
                            <td id="dun-passed">0</td>
                            <td id="dun-failed">0</td>
                            <td id="dun-blocked">0</td>
                            <td id="dun-pending">5</td>
                            <td id="dun-progress">0%</td>
                        </tr>
                        <tr>
                            <td><strong>Data Loader</strong></td>
                            <td>4</td>
                            <td id="dl-passed">0</td>
                            <td id="dl-failed">0</td>
                            <td id="dl-blocked">0</td>
                            <td id="dl-pending">4</td>
                            <td id="dl-progress">0%</td>
                        </tr>
                        <tr>
                            <td><strong>Error Handling</strong></td>
                            <td>3</td>
                            <td id="eh-passed">0</td>
                            <td id="eh-failed">0</td>
                            <td id="eh-blocked">0</td>
                            <td id="eh-pending">3</td>
                            <td id="eh-progress">0%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <h3>Daily Test Execution Status</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Planned Test Cases</th>
                            <th>Executed</th>
                            <th>Passed</th>
                            <th>Failed</th>
                            <th>Daily Notes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Aug 11, 2025</strong></td>
                            <td>SIT-SAP-001, SIT-SAP-002</td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-executed" data-date="aug11"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-passed" data-date="aug11"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-failed" data-date="aug11"></td>
                            <td><input type="text" placeholder="Daily notes..." class="daily-notes" data-date="aug11"></td>
                        </tr>
                        <tr>
                            <td><strong>Aug 12, 2025</strong></td>
                            <td>SIT-SAP-003, SIT-DL-001</td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-executed" data-date="aug12"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-passed" data-date="aug12"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-failed" data-date="aug12"></td>
                            <td><input type="text" placeholder="Daily notes..." class="daily-notes" data-date="aug12"></td>
                        </tr>
                        <tr>
                            <td><strong>Aug 13, 2025</strong></td>
                            <td>SIT-DL-002, SIT-DL-003</td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-executed" data-date="aug13"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-passed" data-date="aug13"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-failed" data-date="aug13"></td>
                            <td><input type="text" placeholder="Daily notes..." class="daily-notes" data-date="aug13"></td>
                        </tr>
                        <tr>
                            <td><strong>Aug 14, 2025</strong></td>
                            <td>SIT-DL-004, SIT-SAP-004</td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-executed" data-date="aug14"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-passed" data-date="aug14"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-failed" data-date="aug14"></td>
                            <td><input type="text" placeholder="Daily notes..." class="daily-notes" data-date="aug14"></td>
                        </tr>
                        <tr>
                            <td><strong>Aug 15, 2025</strong></td>
                            <td>SIT-MC-001, SIT-MC-002</td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-executed" data-date="aug15"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-passed" data-date="aug15"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-failed" data-date="aug15"></td>
                            <td><input type="text" placeholder="Daily notes..." class="daily-notes" data-date="aug15"></td>
                        </tr>
                        <tr>
                            <td><strong>Aug 18, 2025</strong></td>
                            <td>SIT-MC-003, SIT-MC-004</td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-executed" data-date="aug18"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-passed" data-date="aug18"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-failed" data-date="aug18"></td>
                            <td><input type="text" placeholder="Daily notes..." class="daily-notes" data-date="aug18"></td>
                        </tr>
                        <tr>
                            <td><strong>Aug 19, 2025</strong></td>
                            <td>SIT-MC-005, SIT-DUN-001</td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-executed" data-date="aug19"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-passed" data-date="aug19"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-failed" data-date="aug19"></td>
                            <td><input type="text" placeholder="Daily notes..." class="daily-notes" data-date="aug19"></td>
                        </tr>
                        <tr>
                            <td><strong>Aug 20, 2025</strong></td>
                            <td>SIT-DUN-002, SIT-DUN-003</td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-executed" data-date="aug20"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-passed" data-date="aug20"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-failed" data-date="aug20"></td>
                            <td><input type="text" placeholder="Daily notes..." class="daily-notes" data-date="aug20"></td>
                        </tr>
                        <tr>
                            <td><strong>Aug 21, 2025</strong></td>
                            <td>SIT-DUN-004, SIT-DUN-005</td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-executed" data-date="aug21"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-passed" data-date="aug21"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-failed" data-date="aug21"></td>
                            <td><input type="text" placeholder="Daily notes..." class="daily-notes" data-date="aug21"></td>
                        </tr>
                        <tr>
                            <td><strong>Aug 22, 2025</strong></td>
                            <td>End-to-End Integration Testing</td>
                            <td><input type="number" min="0" max="5" value="0" class="daily-executed" data-date="aug22"></td>
                            <td><input type="number" min="0" max="5" value="0" class="daily-passed" data-date="aug22"></td>
                            <td><input type="number" min="0" max="5" value="0" class="daily-failed" data-date="aug22"></td>
                            <td><input type="text" placeholder="Daily notes..." class="daily-notes" data-date="aug22"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- SAP Integration Tab -->
        <div id="sap-integration" class="tab-content">
            <h2 class="section-header">SAP Integration Test Scripts</h2>
            
            <div class="test-category">
                <h4>Test Category: SAP to Salesforce Data Flow</h4>
                <p>Validates the complete data integration pipeline from SAP extraction to Salesforce ingestion</p>
            </div>
            
            <!-- Test Case 1 -->
            <div class="test-step">
                <h5>SIT-SAP-001: ARCUST Customer Master Data Sync</h5>
                
                <div class="test-results-section">
                    <h4>📝 Test Execution Results</h4>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Test Status</label>
                            <select class="status-dropdown" onchange="updateTestStatus('SIT-SAP-001', this.value)">
                                <option value="pending">Pending</option>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                                <option value="blocked">Blocked</option>
                                <option value="na">N/A</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Executed By</label>
                            <input type="text" placeholder="Tester name" data-testid="SIT-SAP-001" data-field="tester">
                        </div>
                        <div class="result-field">
                            <label>Execution Date</label>
                            <input type="date" data-testid="SIT-SAP-001" data-field="date">
                        </div>
                        <div class="result-field">
                            <label>Execution Time (minutes)</label>
                            <input type="number" placeholder="0" data-testid="SIT-SAP-001" data-field="duration">
                        </div>
                        <div class="result-field">
                            <label>Environment</label>
                            <select data-testid="SIT-SAP-001" data-field="environment">
                                <option value="">Select Environment</option>
                                <option value="dev">Development</option>
                                <option value="sit">SIT</option>
                                <option value="uat">UAT</option>
                                <option value="staging">Staging</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Build Version</label>
                            <input type="text" placeholder="v1.0.0" data-testid="SIT-SAP-001" data-field="build">
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field" style="grid-column: 1/-1;">
                            <label>Test Notes / Comments</label>
                            <textarea placeholder="Detailed test execution notes, observations, and comments..." data-testid="SIT-SAP-001" data-field="notes"></textarea>
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Defect ID (if failed)</label>
                            <input type="text" placeholder="DEF-001" data-testid="SIT-SAP-001" data-field="defect">
                        </div>
                        <div class="result-field">
                            <label>Retest Required</label>
                            <select data-testid="SIT-SAP-001" data-field="retest">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                                <option value="partial">Partial</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Priority</label>
                            <select data-testid="SIT-SAP-001" data-field="priority">
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="pre-conditions">
                    <strong>Pre-conditions:</strong>
                    <ul>
                        <li>SAP test system available with customer master data</li>
                        <li>WillScot server accessible with monitoring folder</li>
                        <li>Node.js file watcher script running</li>
                        <li>Salesforce sandbox with Quick Receivables package deployed</li>
                    </ul>
                </div>
                
                <div class="test-data">
                    <strong>Test Data:</strong>
                    <ul>
                        <li>ARCUST20250811.txt - Customer master file with 100 test customers</li>
                        <li>Include: New customers, existing customers with updates, customers with parent-child relationships</li>
                        <li>Multi-currency customers (USD, CAD)</li>
                    </ul>
                </div>
                
                <strong>Test Steps:</strong>
                <ol>
                    <li>Extract customer master data from SAP test system</li>
                    <li>Generate ARCUST20250811.txt file with proper formatting</li>
                    <li>Place file in WillScot server monitoring folder</li>
                    <li>Verify Node.js script detects file automatically</li>
                    <li>Verify file conversion from .txt to .csv with correct headers</li>
                    <li>Verify Data Loader CLI processes file and uploads to Salesforce</li>
                    <li>Validate customer records created/updated in Account object</li>
                    <li>Check success.csv and error.csv log files</li>
                    <li>Verify email notification sent with processing results</li>
                </ol>
                
                <div class="expected-result">
                    <strong>Expected Results:</strong>
                    <ul>
                        <li>All 100 customer records successfully upserted in Salesforce</li>
                        <li>Parent-child relationships properly established</li>
                        <li>Multi-currency fields populated correctly</li>
                        <li>Success log shows 100 processed, 0 errors</li>
                        <li>Email notification received with success status</li>
                    </ul>
                </div>
            </div>
            
            <!-- Test Case 2 -->
            <div class="test-step">
                <h5>SIT-SAP-002: ARMAST Invoice Transaction Data Sync</h5>
                
                <div class="test-results-section">
                    <h4>📝 Test Execution Results</h4>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Test Status</label>
                            <select class="status-dropdown" onchange="updateTestStatus('SIT-SAP-002', this.value)">
                                <option value="pending">Pending</option>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                                <option value="blocked">Blocked</option>
                                <option value="na">N/A</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Executed By</label>
                            <input type="text" placeholder="Tester name" data-testid="SIT-SAP-002" data-field="tester">
                        </div>
                        <div class="result-field">
                            <label>Execution Date</label>
                            <input type="date" data-testid="SIT-SAP-002" data-field="date">
                        </div>
                        <div class="result-field">
                            <label>Execution Time (minutes)</label>
                            <input type="number" placeholder="0" data-testid="SIT-SAP-002" data-field="duration">
                        </div>
                        <div class="result-field">
                            <label>Environment</label>
                            <select data-testid="SIT-SAP-002" data-field="environment">
                                <option value="">Select Environment</option>
                                <option value="dev">Development</option>
                                <option value="sit">SIT</option>
                                <option value="uat">UAT</option>
                                <option value="staging">Staging</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Build Version</label>
                            <input type="text" placeholder="v1.0.0" data-testid="SIT-SAP-002" data-field="build">
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field" style="grid-column: 1/-1;">
                            <label>Test Notes / Comments</label>
                            <textarea placeholder="Detailed test execution notes, observations, and comments..." data-testid="SIT-SAP-002" data-field="notes"></textarea>
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Defect ID (if failed)</label>
                            <input type="text" placeholder="DEF-002" data-testid="SIT-SAP-002" data-field="defect">
                        </div>
                        <div class="result-field">
                            <label>Retest Required</label>
                            <select data-testid="SIT-SAP-002" data-field="retest">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                                <option value="partial">Partial</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Priority</label>
                            <select data-testid="SIT-SAP-002" data-field="priority">
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="test-data">
                    <strong>Test Data:</strong>
                    <ul>
                        <li>ARMAST20250811.txt - Invoice transaction file with 500 test invoices</li>
                        <li>Include: Open invoices, credit memos, different document types</li>
                        <li>Various aging buckets (current, 30, 60, 90+ days)</li>
                        <li>Different payment terms and due dates</li>
                    </ul>
                </div>
                
                <strong>Test Steps:</strong>
                <ol>
                    <li>Ensure ARCUST data is already loaded (dependency)</li>
                    <li>Extract invoice transaction data from SAP</li>
                    <li>Generate ARMAST20250811.txt with proper invoice records</li>
                    <li>Place file in monitoring folder</li>
                    <li>Verify automatic detection and processing</li>
                    <li>Verify DueDate calculation (INVDTE + PNET days)</li>
                    <li>Validate invoice records created in Invoice__c object</li>
                    <li>Check proper linking to Account records</li>
                    <li>Verify DPD (Days Past Due) calculations</li>
                </ol>
                
                <div class="expected-result">
                    <strong>Expected Results:</strong>
                    <ul>
                        <li>All 500 invoice records successfully created</li>
                        <li>Proper Account lookups established</li>
                        <li>DueDate calculated correctly for all records</li>
                        <li>DPD values calculated based on current date</li>
                        <li>Aging buckets properly categorized</li>
                    </ul>
                </div>
            </div>
            
            <!-- Test Case 3 -->
            <div class="test-step">
                <h5>SIT-SAP-003: ARCASH Payment History Sync</h5>
                
                <div class="test-results-section">
                    <h4>📝 Test Execution Results</h4>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Test Status</label>
                            <select class="status-dropdown" onchange="updateTestStatus('SIT-SAP-003', this.value)">
                                <option value="pending">Pending</option>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                                <option value="blocked">Blocked</option>
                                <option value="na">N/A</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Executed By</label>
                            <input type="text" placeholder="Tester name" data-testid="SIT-SAP-003" data-field="tester">
                        </div>
                        <div class="result-field">
                            <label>Execution Date</label>
                            <input type="date" data-testid="SIT-SAP-003" data-field="date">
                        </div>
                        <div class="result-field">
                            <label>Execution Time (minutes)</label>
                            <input type="number" placeholder="0" data-testid="SIT-SAP-003" data-field="duration">
                        </div>
                        <div class="result-field">
                            <label>Environment</label>
                            <select data-testid="SIT-SAP-003" data-field="environment">
                                <option value="">Select Environment</option>
                                <option value="dev">Development</option>
                                <option value="sit">SIT</option>
                                <option value="uat">UAT</option>
                                <option value="staging">Staging</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Build Version</label>
                            <input type="text" placeholder="v1.0.0" data-testid="SIT-SAP-003" data-field="build">
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field" style="grid-column: 1/-1;">
                            <label>Test Notes / Comments</label>
                            <textarea placeholder="Detailed test execution notes, observations, and comments..." data-testid="SIT-SAP-003" data-field="notes"></textarea>
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Defect ID (if failed)</label>
                            <input type="text" placeholder="DEF-003" data-testid="SIT-SAP-003" data-field="defect">
                        </div>
                        <div class="result-field">
                            <label>Retest Required</label>
                            <select data-testid="SIT-SAP-003" data-field="retest">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                                <option value="partial">Partial</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Priority</label>
                            <select data-testid="SIT-SAP-003" data-field="priority">
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="test-data">
                    <strong>Test Data:</strong>
                    <ul>
                        <li>ARCASH20250811.txt - Payment transaction file</li>
                        <li>Include: Full payments, partial payments, adjustments, write-offs</li>
                        <li>Different payment methods (check, ACH, wire, credit card)</li>
                        <li>Bank indicators and batch numbers</li>
                    </ul>
                </div>
                
                <strong>Test Steps:</strong>
                <ol>
                    <li>Ensure ARMAST data is loaded (dependency)</li>
                    <li>Extract payment data from SAP</li>
                    <li>Generate ARCASH20250811.txt file</li>
                    <li>Process file through automation pipeline</li>
                    <li>Verify payment records created in Payment__c object</li>
                    <li>Check proper invoice linkage</li>
                    <li>Validate payment application logic</li>
                    <li>Verify invoice balance updates</li>
                </ol>
                
                <div class="expected-result">
                    <strong>Expected Results:</strong>
                    <ul>
                        <li>Payment records created with proper invoice links</li>
                        <li>Invoice balances updated correctly</li>
                        <li>Payment methods and bank details captured</li>
                        <li>Closed invoices marked as paid</li>
                    </ul>
                </div>
            </div>

            <!-- New Test Case 4 -->
            <div class="test-step">
                <h5>SIT-SAP-004: Data Transformation Validation</h5>
                
                <div class="test-results-section">
                    <h4>📝 Test Execution Results</h4>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Test Status</label>
                            <select class="status-dropdown" onchange="updateTestStatus('SIT-SAP-004', this.value)">
                                <option value="pending">Pending</option>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                                <option value="blocked">Blocked</option>
                                <option value="na">N/A</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Executed By</label>
                            <input type="text" placeholder="Tester name" data-testid="SIT-SAP-004" data-field="tester">
                        </div>
                        <div class="result-field">
                            <label>Execution Date</label>
                            <input type="date" data-testid="SIT-SAP-004" data-field="date">
                        </div>
                        <div class="result-field">
                            <label>Execution Time (minutes)</label>
                            <input type="number" placeholder="0" data-testid="SIT-SAP-004" data-field="duration">
                        </div>
                        <div class="result-field">
                            <label>Environment</label>
                            <select data-testid="SIT-SAP-004" data-field="environment">
                                <option value="">Select Environment</option>
                                <option value="dev">Development</option>
                                <option value="sit">SIT</option>
                                <option value="uat">UAT</option>
                                <option value="staging">Staging</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Build Version</label>
                            <input type="text" placeholder="v1.0.0" data-testid="SIT-SAP-004" data-field="build">
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field" style="grid-column: 1/-1;">
                            <label>Test Notes / Comments</label>
                            <textarea placeholder="Detailed test execution notes, observations, and comments..." data-testid="SIT-SAP-004" data-field="notes"></textarea>
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Defect ID (if failed)</label>
                            <input type="text" placeholder="DEF-010" data-testid="SIT-SAP-004" data-field="defect">
                        </div>
                        <div class="result-field">
                            <label>Retest Required</label>
                            <select data-testid="SIT-SAP-004" data-field="retest">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                                <option value="partial">Partial</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Priority</label>
                            <select data-testid="SIT-SAP-004" data-field="priority">
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="pre-conditions">
                    <strong>Pre-conditions:</strong>
                    <ul>
                        <li>Data mapping specifications from SAP to Salesforce are finalized.</li>
                        <li>Transformation logic implemented in Node.js scripts.</li>
                    </ul>
                </div>
                
                <div class="test-data">
                    <strong>Test Data:</strong>
                    <ul>
                        <li>Sample data files with various data types and edge cases (e.g., null values, special characters).</li>
                    </ul>
                </div>
                
                <strong>Test Steps:</strong>
                <ol>
                    <li>Process sample SAP data files through the Node.js transformation scripts.</li>
                    <li>Manually inspect the generated CSV files for correct data types, formats, and values.</li>
                    <li>Verify that all required fields are present and correctly mapped.</li>
                    <li>Test edge cases such as empty strings, large numbers, and date formats.</li>
                </ol>
                
                <div class="expected-result">
                    <strong>Expected Results:</strong>
                    <ul>
                        <li>Transformed data matches the specified Salesforce field requirements.</li>
                        <li>No data loss or corruption occurs during transformation.</li>
                        <li>All data types are correctly converted.</li>
                    </ul>
                </div>
            </div>

            <!-- New Test Case 5 (Error Handling for SAP) -->
            <div class="test-step">
                <h5>SIT-SAP-005: SAP Data Error Handling</h5>
                
                <div class="test-results-section">
                    <h4>📝 Test Execution Results</h4>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Test Status</label>
                            <select class="status-dropdown" onchange="updateTestStatus('SIT-SAP-005', this.value)">
                                <option value="pending">Pending</option>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                                <option value="blocked">Blocked</option>
                                <option value="na">N/A</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Executed By</label>
                            <input type="text" placeholder="Tester name" data-testid="SIT-SAP-005" data-field="tester">
                        </div>
                        <div class="result-field">
                            <label>Execution Date</label>
                            <input type="date" data-testid="SIT-SAP-005" data-field="date">
                        </div>
                        <div class="result-field">
                            <label>Execution Time (minutes)</label>
                            <input type="number" placeholder="0" data-testid="SIT-SAP-005" data-field="duration">
                        </div>
                        <div class="result-field">
                            <label>Environment</label>
                            <select data-testid="SIT-SAP-005" data-field="environment">
                                <option value="">Select Environment</option>
                                <option value="dev">Development</option>
                                <option value="sit">SIT</option>
                                <option value="uat">UAT</option>
                                <option value="staging">Staging</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Build Version</label>
                            <input type="text" placeholder="v1.0.0" data-testid="SIT-SAP-005" data-field="build">
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field" style="grid-column: 1/-1;">
                            <label>Test Notes / Comments</label>
                            <textarea placeholder="Detailed test execution notes, observations, and comments..." data-testid="SIT-SAP-005" data-field="notes"></textarea>
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Defect ID (if failed)</label>
                            <input type="text" placeholder="DEF-011" data-testid="SIT-SAP-005" data-field="defect">
                        </div>
                        <div class="result-field">
                            <label>Retest Required</label>
                            <select data-testid="SIT-SAP-005" data-field="retest">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                                <option value="partial">Partial</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Priority</label>
                            <select data-testid="SIT-SAP-005" data-field="priority">
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="pre-conditions">
                    <strong>Pre-conditions:</strong>
                    <ul>
                        <li>Error logging and notification mechanisms are in place for SAP data processing.</li>
                    </ul>
                </div>
                
                <div class="test-data">
                    <strong>Test Data:</strong>
                    <ul>
                        <li>Corrupted SAP data files (e.g., malformed records, incorrect delimiters).</li>
                        <li>Files with missing mandatory fields.</li>
                    </ul>
                </div>
                
                <strong>Test Steps:</strong>
                <ol>
                    <li>Introduce corrupted or invalid data into SAP extract files.</li>
                    <li>Place these files in the monitoring folder.</li>
                    <li>Verify that the Node.js scripts correctly identify and log data errors.</li>
                    <li>Check that error notifications are sent to the appropriate recipients.</li>
                    <li>Confirm that valid records in the same file (if any) are processed successfully, and invalid ones are skipped or quarantined.</li>
                </ol>
                
                <div class="expected-result">
                    <strong>Expected Results:</strong>
                    <ul>
                        <li>Data processing errors are accurately logged.</li>
                        <li>Error notifications are sent with sufficient detail for troubleshooting.</li>
                        <li>System gracefully handles invalid input without crashing or processing incorrect data.</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- Marketing Cloud Tab -->
        <div id="marketing-cloud" class="tab-content">
            <h2 class="section-header">Marketing Cloud Integration Test Scripts</h2>
            
            <div class="test-category">
                <h4>Test Category: Salesforce - Marketing Cloud Dunning Integration</h4>
                <p>Validates automated dunning email flows and engagement tracking</p>
            </div>
            
            <div class="test-step">
                <h5>SIT-MC-001: Marketing Cloud Connect Data Sync</h5>
                
                <div class="test-results-section">
                    <h4>📝 Test Execution Results</h4>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Test Status</label>
                            <select class="status-dropdown" onchange="updateTestStatus('SIT-MC-001', this.value)">
                                <option value="pending">Pending</option>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                                <option value="blocked">Blocked</option>
                                <option value="na">N/A</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Executed By</label>
                            <input type="text" placeholder="Tester name" data-testid="SIT-MC-001" data-field="tester">
                        </div>
                        <div class="result-field">
                            <label>Execution Date</label>
                            <input type="date" data-testid="SIT-MC-001" data-field="date">
                        </div>
                        <div class="result-field">
                            <label>Execution Time (minutes)</label>
                            <input type="number" placeholder="0" data-testid="SIT-MC-001" data-field="duration">
                        </div>
                        <div class="result-field">
                            <label>Environment</label>
                            <select data-testid="SIT-MC-001" data-field="environment">
                                <option value="">Select Environment</option>
                                <option value="dev">Development</option>
                                <option value="sit">SIT</option>
                                <option value="uat">UAT</option>
                                <option value="staging">Staging</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Build Version</label>
                            <input type="text" placeholder="v1.0.0" data-testid="SIT-MC-001" data-field="build">
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field" style="grid-column: 1/-1;">
                            <label>Test Notes / Comments</label>
                            <textarea placeholder="Detailed test execution notes, observations, and comments..." data-testid="SIT-MC-001" data-field="notes"></textarea>
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Defect ID (if failed)</label>
                            <input type="text" placeholder="DEF-004" data-testid="SIT-MC-001" data-field="defect">
                        </div>
                        <div class="result-field">
                            <label>Retest Required</label>
                            <select data-testid="SIT-MC-001" data-field="retest">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                                <option value="partial">Partial</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Priority</label>
                            <select data-testid="SIT-MC-001" data-field="priority">
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="pre-conditions">
                    <strong>Pre-conditions:</strong>
                    <ul>
                        <li>Marketing Cloud Connect installed and configured</li>
                        <li>Data Extensions created for Account, Contact, Invoice data</li>
                        <li>SOQL-based synchronized data sources configured</li>
                        <li>Test customers with overdue invoices loaded</li>
                    </ul>
                </div>
                
                <strong>Test Steps:</strong>
                <ol>
                    <li>Create test customers with overdue invoices in Salesforce</li>
                    <li>Trigger data sync from Salesforce to Marketing Cloud</li>
                    <li>Verify Account data populated in MC Data Extension</li>
                    <li>Verify Contact data synced with email addresses</li>
                    <li>Verify Invoice data synced with aging information</li>
                    <li>Check data freshness and sync timing</li>
                    <li>Validate field mappings and data transformation</li>
                </ol>
                
                <div class="expected-result">
                    <strong>Expected Results:</strong>
                    <ul>
                        <li>All customer data synced to Marketing Cloud within defined timeframe</li>
                        <li>Field mappings accurate between systems</li>
                        <li>Overdue invoice data properly segmented</li>
                        <li>Contact email addresses validated and deliverable</li>
                    </ul>
                </div>
            </div>

            <!-- New Test Case 2 -->
            <div class="test-step">
                <h5>SIT-MC-002: Dunning Email Send Verification</h5>
                
                <div class="test-results-section">
                    <h4>📝 Test Execution Results</h4>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Test Status</label>
                            <select class="status-dropdown" onchange="updateTestStatus('SIT-MC-002', this.value)">
                                <option value="pending">Pending</option>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                                <option value="blocked">Blocked</option>
                                <option value="na">N/A</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Executed By</label>
                            <input type="text" placeholder="Tester name" data-testid="SIT-MC-002" data-field="tester">
                        </div>
                        <div class="result-field">
                            <label>Execution Date</label>
                            <input type="date" data-testid="SIT-MC-002" data-field="date">
                        </div>
                        <div class="result-field">
                            <label>Execution Time (minutes)</label>
                            <input type="number" placeholder="0" data-testid="SIT-MC-002" data-field="duration">
                        </div>
                        <div class="result-field">
                            <label>Environment</label>
                            <select data-testid="SIT-MC-002" data-field="environment">
                                <option value="">Select Environment</option>
                                <option value="dev">Development</option>
                                <option value="sit">SIT</option>
                                <option value="uat">UAT</option>
                                <option value="staging">Staging</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Build Version</label>
                            <input type="text" placeholder="v1.0.0" data-testid="SIT-MC-002" data-field="build">
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field" style="grid-column: 1/-1;">
                            <label>Test Notes / Comments</label>
                            <textarea placeholder="Detailed test execution notes, observations, and comments..." data-testid="SIT-MC-002" data-field="notes"></textarea>
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Defect ID (if failed)</label>
                            <input type="text" placeholder="DEF-012" data-testid="SIT-MC-002" data-field="defect">
                        </div>
                        <div class="result-field">
                            <label>Retest Required</label>
                            <select data-testid="SIT-MC-002" data-field="retest">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                                <option value="partial">Partial</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Priority</label>
                            <select data-testid="SIT-MC-002" data-field="priority">
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="pre-conditions">
                    <strong>Pre-conditions:</strong>
                    <ul>
                        <li>Dunning journeys are active in Marketing Cloud.</li>
                        <li>Test contacts are subscribed to relevant data extensions.</li>
                    </ul>
                </div>
                
                <div class="test-data">
                    <strong>Test Data:</strong>
                    <ul>
                        <li>Test contacts with overdue invoices triggering DPD milestones (e.g., DPD 1, DPD 30).</li>
                        <li>Valid email addresses for test contacts.</li>
                    </ul>
                </div>
                
                <strong>Test Steps:</strong>
                <ol>
                    <li>Ensure test contacts have overdue invoices that meet the criteria for a dunning email.</li>
                    <li>Verify that the dunning email is sent from Marketing Cloud to the test contact's email address.</li>
                    <li>Check the content and personalization of the email (e.g., correct invoice details, customer name).</li>
                    <li>Verify the sender profile and reply-to address are correct.</li>
                    <li>Confirm that the email appears in the test contact's inbox.</li>
                </ol>
                
                <div class="expected-result">
                    <strong>Expected Results:</strong>
                    <ul>
                        <li>Dunning emails are sent automatically based on DPD rules.</li>
                        <li>Email content is accurate and personalized.</li>
                        <li>Emails are delivered to the intended recipients.</li>
                    </ul>
                </div>
            </div>

            <!-- New Test Case 3 -->
            <div class="test-step">
                <h5>SIT-MC-003: Email Open/Click Tracking</h5>
                
                <div class="test-results-section">
                    <h4>📝 Test Execution Results</h4>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Test Status</label>
                            <select class="status-dropdown" onchange="updateTestStatus('SIT-MC-003', this.value)">
                                <option value="pending">Pending</option>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                                <option value="blocked">Blocked</option>
                                <option value="na">N/A</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Executed By</label>
                            <input type="text" placeholder="Tester name" data-testid="SIT-MC-003" data-field="tester">
                        </div>
                        <div class="result-field">
                            <label>Execution Date</label>
                            <input type="date" data-testid="SIT-MC-003" data-field="date">
                        </div>
                        <div class="result-field">
                            <label>Execution Time (minutes)</label>
                            <input type="number" placeholder="0" data-testid="SIT-MC-003" data-field="duration">
                        </div>
                        <div class="result-field">
                            <label>Environment</label>
                            <select data-testid="SIT-MC-003" data-field="environment">
                                <option value="">Select Environment</option>
                                <option value="dev">Development</option>
                                <option value="sit">SIT</option>
                                <option value="uat">UAT</option>
                                <option value="staging">Staging</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Build Version</label>
                            <input type="text" placeholder="v1.0.0" data-testid="SIT-MC-003" data-field="build">
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field" style="grid-column: 1/-1;">
                            <label>Test Notes / Comments</label>
                            <textarea placeholder="Detailed test execution notes, observations, and comments..." data-testid="SIT-MC-003" data-field="notes"></textarea>
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Defect ID (if failed)</label>
                            <input type="text" placeholder="DEF-013" data-testid="SIT-MC-003" data-field="defect">
                        </div>
                        <div class="result-field">
                            <label>Retest Required</label>
                            <select data-testid="SIT-MC-003" data-field="retest">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                                <option value="partial">Partial</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Priority</label>
                            <select data-testid="SIT-MC-003" data-field="priority">
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="pre-conditions">
                    <strong>Pre-conditions:</strong>
                    <ul>
                        <li>Email tracking is enabled in Marketing Cloud.</li>
                        <li>Test emails contain trackable links.</li>
                    </ul>
                </div>
                
                <div class="test-data">
                    <strong>Test Data:</strong>
                    <ul>
                        <li>Test dunning email with a link to a payment portal or invoice view.</li>
                    </ul>
                </div>
                
                <strong>Test Steps:</strong>
                <ol>
                    <li>Send a dunning email to a test contact.</li>
                    <li>Open the email and click on the embedded links.</li>
                    <li>Verify that Marketing Cloud correctly registers the email open and click events.</li>
                    <li>Check if these engagement metrics are visible in Salesforce (if synced).</li>
                </ol>
                
                <div class="expected-result">
                    <strong>Expected Results:</strong>
                    <ul>
                        <li>Email opens and clicks are accurately tracked in Marketing Cloud.</li>
                        <li>Engagement data is visible and consistent in Salesforce.</li>
                    </ul>
                </div>
            </div>

            <!-- New Test Case 4 -->
            <div class="test-step">
                <h5>SIT-MC-004: Bounce and Unsubscribe Handling</h5>
                
                <div class="test-results-section">
                    <h4>📝 Test Execution Results</h4>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Test Status</label>
                            <select class="status-dropdown" onchange="updateTestStatus('SIT-MC-004', this.value)">
                                <option value="pending">Pending</option>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                                <option value="blocked">Blocked</option>
                                <option value="na">N/A</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Executed By</label>
                            <input type="text" placeholder="Tester name" data-testid="SIT-MC-004" data-field="tester">
                        </div>
                        <div class="result-field">
                            <label>Execution Date</label>
                            <input type="date" data-testid="SIT-MC-004" data-field="date">
                        </div>
                        <div class="result-field">
                            <label>Execution Time (minutes)</label>
                            <input type="number" placeholder="0" data-testid="SIT-MC-004" data-field="duration">
                        </div>
                        <div class="result-field">
                            <label>Environment</label>
                            <select data-testid="SIT-MC-004" data-field="environment">
                                <option value="">Select Environment</option>
                                <option value="dev">Development</option>
                                <option value="sit">SIT</option>
                                <option value="uat">UAT</option>
                                <option value="staging">Staging</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Build Version</label>
                            <input type="text" placeholder="v1.0.0" data-testid="SIT-MC-004" data-field="build">
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field" style="grid-column: 1/-1;">
                            <label>Test Notes / Comments</label>
                            <textarea placeholder="Detailed test execution notes, observations, and comments..." data-testid="SIT-MC-004" data-field="notes"></textarea>
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Defect ID (if failed)</label>
                            <input type="text" placeholder="DEF-014" data-testid="SIT-MC-004" data-field="defect">
                        </div>
                        <div class="result-field">
                            <label>Retest Required</label>
                            <select data-testid="SIT-MC-004" data-field="retest">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                                <option value="partial">Partial</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Priority</label>
                            <select data-testid="SIT-MC-004" data-field="priority">
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="pre-conditions">
                    <strong>Pre-conditions:</strong>
                    <ul>
                        <li>Marketing Cloud bounce and unsubscribe settings are configured.</li>
                        <li>Test email addresses for hard/soft bounces are available.</li>
                    </ul>
                </div>
                
                <div class="test-data">
                    <strong>Test Data:</strong>
                    <ul>
                        <li>Test contact with an invalid email address (for hard bounce).</li>
                        <li>Test contact with a full inbox (for soft bounce).</li>
                        <li>Test contact to perform an unsubscribe action.</li>
                    </ul>
                </div>
                
                <strong>Test Steps:</strong>
                <ol>
                    <li>Send a dunning email to a test contact with an invalid email address.</li>
                    <li>Verify that the email hard bounces in Marketing Cloud.</li>
                    <li>Check if the contact's status is updated accordingly (e.g., unsubscribed, bounced).</li>
                    <li>Send a dunning email to a test contact and perform an unsubscribe action.</li>
                    <li>Verify the unsubscribe is registered in Marketing Cloud and Salesforce.</li>
                </ol>
                
                <div class="expected-result">
                    <strong>Expected Results:</strong>
                    <ul>
                        <li>Hard bounces result in the contact being unsubscribed or marked as undeliverable.</li>
                        <li>Soft bounces are handled gracefully without immediate unsubscribe.</li>
                        <li>Unsubscribe actions are correctly processed and synced to Salesforce.</li>
                    </ul>
                </div>
            </div>

            <!-- New Test Case 5 -->
            <div class="test-step">
                <h5>SIT-MC-005: Journey Builder Integration</h5>
                
                <div class="test-results-section">
                    <h4>📝 Test Execution Results</h4>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Test Status</label>
                            <select class="status-dropdown" onchange="updateTestStatus('SIT-MC-005', this.value)">
                                <option value="pending">Pending</option>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                                <option value="blocked">Blocked</option>
                                <option value="na">N/A</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Executed By</label>
                            <input type="text" placeholder="Tester name" data-testid="SIT-MC-005" data-field="tester">
                        </div>
                        <div class="result-field">
                            <label>Execution Date</label>
                            <input type="date" data-testid="SIT-MC-005" data-field="date">
                        </div>
                        <div class="result-field">
                            <label>Execution Time (minutes)</label>
                            <input type="number" placeholder="0" data-testid="SIT-MC-005" data-field="duration">
                        </div>
                        <div class="result-field">
                            <label>Environment</label>
                            <select data-testid="SIT-MC-005" data-field="environment">
                                <option value="">Select Environment</option>
                                <option value="dev">Development</option>
                                <option value="sit">SIT</option>
                                <option value="uat">UAT</option>
                                <option value="staging">Staging</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Build Version</label>
                            <input type="text" placeholder="v1.0.0" data-testid="SIT-MC-005" data-field="build">
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field" style="grid-column: 1/-1;">
                            <label>Test Notes / Comments</label>
                            <textarea placeholder="Detailed test execution notes, observations, and comments..." data-testid="SIT-MC-005" data-field="notes"></textarea>
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Defect ID (if failed)</label>
                            <input type="text" placeholder="DEF-015" data-testid="SIT-MC-005" data-field="defect">
                        </div>
                        <div class="result-field">
                            <label>Retest Required</label>
                            <select data-testid="SIT-MC-005" data-field="retest">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                                <option value="partial">Partial</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Priority</label>
                            <select data-testid="SIT-MC-005" data-field="priority">
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="pre-conditions">
                    <strong>Pre-conditions:</strong>
                    <ul>
                        <li>Dunning journeys are configured in Journey Builder with appropriate entry events.</li>
                        <li>Salesforce data is correctly mapped to Journey Builder entry data extensions.</li>
                    </ul>
                </div>
                
                <div class="test-data">
                    <strong>Test Data:</strong>
                    <ul>
                        <li>Test contacts whose overdue invoice status will trigger entry into a dunning journey.</li>
                    </ul>
                </div>
                
                <strong>Test Steps:</strong>
                <ol>
                    <li>Create or update an invoice in Salesforce for a test contact to meet a dunning journey entry criterion.</li>
                    <li>Verify that the test contact enters the correct dunning journey in Marketing Cloud.</li>
                    <li>Track the contact's progression through the journey steps (e.g., email sends, wait steps).</li>
                    <li>Verify that subsequent emails or activities in the journey are triggered as expected.</li>
                    <li>Test exit criteria from the journey (e.g., invoice paid).</li>
                </ol>
                
                <div class="expected-result">
                    <strong>Expected Results:</strong>
                    <ul>
                        <li>Contacts enter dunning journeys accurately based on Salesforce data.</li>
                        <li>Journey steps (emails, waits, decisions) execute as designed.</li>
                        <li>Contacts exit journeys correctly upon meeting exit criteria.</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- Dunning Automation Tab -->
        <div id="dunning-automation" class="tab-content">
            <h2 class="section-header">Dunning Task Automation Test Scripts</h2>
            
            <div class="test-category">
                <h4>Test Category: Automated Dunning Task Creation</h4>
                <p>Validates Custom Metadata-driven task automation and DPD milestone processing</p>
            </div>
            
            <div class="test-step">
                <h5>SIT-DUN-001: Custom Metadata Configuration</h5>
                
                <div class="test-results-section">
                    <h4>📝 Test Execution Results</h4>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Test Status</label>
                            <select class="status-dropdown" onchange="updateTestStatus('SIT-DUN-001', this.value)">
                                <option value="pending">Pending</option>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                                <option value="blocked">Blocked</option>
                                <option value="na">N/A</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Executed By</label>
                            <input type="text" placeholder="Tester name" data-testid="SIT-DUN-001" data-field="tester">
                        </div>
                        <div class="result-field">
                            <label>Execution Date</label>
                            <input type="date" data-testid="SIT-DUN-001" data-field="date">
                        </div>
                        <div class="result-field">
                            <label>Execution Time (minutes)</label>
                            <input type="number" placeholder="0" data-testid="SIT-DUN-001" data-field="duration">
                        </div>
                        <div class="result-field">
                            <label>Environment</label>
                            <select data-testid="SIT-DUN-001" data-field="environment">
                                <option value="">Select Environment</option>
                                <option value="dev">Development</option>
                                <option value="sit">SIT</option>
                                <option value="uat">UAT</option>
                                <option value="staging">Staging</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Build Version</label>
                            <input type="text" placeholder="v1.0.0" data-testid="SIT-DUN-001" data-field="build">
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field" style="grid-column: 1/-1;">
                            <label>Test Notes / Comments</label>
                            <textarea placeholder="Detailed test execution notes, observations, and comments..." data-testid="SIT-DUN-001" data-field="notes"></textarea>
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Defect ID (if failed)</label>
                            <input type="text" placeholder="DEF-005" data-testid="SIT-DUN-001" data-field="defect">
                        </div>
                        <div class="result-field">
                            <label>Retest Required</label>
                            <select data-testid="SIT-DUN-001" data-field="retest">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                                <option value="partial">Partial</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Priority</label>
                            <select data-testid="SIT-DUN-001" data-field="priority">
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="pre-conditions">
                    <strong>Pre-conditions:</strong>
                    <ul>
                        <li>DunningTaskConfiguration__mdt custom metadata type deployed</li>
                        <li>Dunning_Task_Run_Log__c custom object created</li>
                        <li>Test invoice data with various DPD values loaded</li>
                    </ul>
                </div>
                
                <strong>Test Steps:</strong>
                <ol>
                    <li>Configure Custom Metadata records for DPD milestones</li>
                    <li>Verify CMDT fields populated correctly</li>
                    <li>Test activation/deactivation of rules</li>
                    <li>Validate metadata accessibility from Apex</li>
                </ol>
                
                <div class="expected-result">
                    <strong>Expected Results:</strong>
                    <ul>
                        <li>All CMDT records created successfully</li>
                        <li>Metadata queryable from Apex batch class</li>
                        <li>Rule activation/deactivation working</li>
                        <li>Field mappings accessible programmatically</li>
                    </ul>
                </div>
            </div>

            <!-- New Test Case 2 -->
            <div class="test-step">
                <h5>SIT-DUN-002: Automated Task Creation - DPD 30</h5>
                
                <div class="test-results-section">
                    <h4>📝 Test Execution Results</h4>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Test Status</label>
                            <select class="status-dropdown" onchange="updateTestStatus('SIT-DUN-002', this.value)">
                                <option value="pending">Pending</option>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                                <option value="blocked">Blocked</option>
                                <option value="na">N/A</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Executed By</label>
                            <input type="text" placeholder="Tester name" data-testid="SIT-DUN-002" data-field="tester">
                        </div>
                        <div class="result-field">
                            <label>Execution Date</label>
                            <input type="date" data-testid="SIT-DUN-002" data-field="date">
                        </div>
                        <div class="result-field">
                            <label>Execution Time (minutes)</label>
                            <input type="number" placeholder="0" data-testid="SIT-DUN-002" data-field="duration">
                        </div>
                        <div class="result-field">
                            <label>Environment</label>
                            <select data-testid="SIT-DUN-002" data-field="environment">
                                <option value="">Select Environment</option>
                                <option value="dev">Development</option>
                                <option value="sit">SIT</option>
                                <option value="uat">UAT</option>
                                <option value="staging">Staging</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Build Version</label>
                            <input type="text" placeholder="v1.0.0" data-testid="SIT-DUN-002" data-field="build">
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field" style="grid-column: 1/-1;">
                            <label>Test Notes / Comments</label>
                            <textarea placeholder="Detailed test execution notes, observations, and comments..." data-testid="SIT-DUN-002" data-field="notes"></textarea>
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Defect ID (if failed)</label>
                            <input type="text" placeholder="DEF-016" data-testid="SIT-DUN-002" data-field="defect">
                        </div>
                        <div class="result-field">
                            <label>Retest Required</label>
                            <select data-testid="SIT-DUN-002" data-field="retest">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                                <option value="partial">Partial</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Priority</label>
                            <select data-testid="SIT-DUN-002" data-field="priority">
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="pre-conditions">
                    <strong>Pre-conditions:</strong>
                    <ul>
                        <li>Invoice records with DPD 30 are present in Salesforce.</li>
                        <li>Automated task creation rule for DPD 30 is active in Custom Metadata.</li>
                    </ul>
                </div>
                
                <div class="test-data">
                    <strong>Test Data:</strong>
                    <ul>
                        <li>Test invoice records with `Days_Past_Due__c` = 30.</li>
                    </ul>
                </div>
                
                <strong>Test Steps:</strong>
                <ol>
                    <li>Create or update invoice records in Salesforce to have `Days_Past_Due__c` = 30.</li>
                    <li>Run the scheduled Apex job for dunning task automation.</li>
                    <li>Verify that a new Task record is created in Salesforce for each relevant invoice.</li>
                    <li>Check the Task details (Subject, Due Date, Assigned To, Comments) against CMDT configuration.</li>
                    <li>Verify a Dunning_Task_Run_Log__c record is created for the execution.</li>
                </ol>
                
                <div class="expected-result">
                    <strong>Expected Results:</strong>
                    <ul>
                        <li>Tasks are created automatically for DPD 30 invoices.</li>
                        <li>Task details match the configuration in Custom Metadata.</li>
                        <li>Audit logs (`Dunning_Task_Run_Log__c`) are correctly updated.</li>
                    </ul>
                </div>
            </div>

            <!-- New Test Case 3 -->
            <div class="test-step">
                <h5>SIT-DUN-003: Automated Task Creation - DPD 60</h5>
                
                <div class="test-results-section">
                    <h4>📝 Test Execution Results</h4>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Test Status</label>
                            <select class="status-dropdown" onchange="updateTestStatus('SIT-DUN-003', this.value)">
                                <option value="pending">Pending</option>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                                <option value="blocked">Blocked</option>
                                <option value="na">N/A</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Executed By</label>
                            <input type="text" placeholder="Tester name" data-testid="SIT-DUN-003" data-field="tester">
                        </div>
                        <div class="result-field">
                            <label>Execution Date</label>
                            <input type="date" data-testid="SIT-DUN-003" data-field="date">
                        </div>
                        <div class="result-field">
                            <label>Execution Time (minutes)</label>
                            <input type="number" placeholder="0" data-testid="SIT-DUN-003" data-field="duration">
                        </div>
                        <div class="result-field">
                            <label>Environment</label>
                            <select data-testid="SIT-DUN-003" data-field="environment">
                                <option value="">Select Environment</option>
                                <option value="dev">Development</option>
                                <option value="sit">SIT</option>
                                <option value="uat">UAT</option>
                                <option value="staging">Staging</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Build Version</label>
                            <input type="text" placeholder="v1.0.0" data-testid="SIT-DUN-003" data-field="build">
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field" style="grid-column: 1/-1;">
                            <label>Test Notes / Comments</label>
                            <textarea placeholder="Detailed test execution notes, observations, and comments..." data-testid="SIT-DUN-003" data-field="notes"></textarea>
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Defect ID (if failed)</label>
                            <input type="text" placeholder="DEF-017" data-testid="SIT-DUN-003" data-field="defect">
                        </div>
                        <div class="result-field">
                            <label>Retest Required</label>
                            <select data-testid="SIT-DUN-003" data-field="retest">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                                <option value="partial">Partial</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Priority</label>
                            <select data-testid="SIT-DUN-003" data-field="priority">
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="pre-conditions">
                    <strong>Pre-conditions:</strong>
                    <ul>
                        <li>Invoice records with DPD 60 are present in Salesforce.</li>
                        <li>Automated task creation rule for DPD 60 is active in Custom Metadata.</li>
                    </ul>
                </div>
                
                <div class="test-data">
                    <strong>Test Data:</strong>
                    <ul>
                        <li>Test invoice records with `Days_Past_Due__c` = 60.</li>
                    </ul>
                </div>
                
                <strong>Test Steps:</strong>
                <ol>
                    <li>Create or update invoice records in Salesforce to have `Days_Past_Due__c` = 60.</li>
                    <li>Run the scheduled Apex job for dunning task automation.</li>
                    <li>Verify that a new Task record is created in Salesforce for each relevant invoice.</li>
                    <li>Check the Task details (Subject, Due Date, Assigned To, Comments) against CMDT configuration.</li>
                    <li>Verify no duplicate tasks are created if a DPD 30 task already exists.</li>
                </ol>
                
                <div class="expected-result">
                    <strong>Expected Results:</strong>
                    <ul>
                        <li>Tasks are created automatically for DPD 60 invoices.</li>
                        <li>Task details match the configuration in Custom Metadata.</li>
                        <li>Only one task exists per invoice for the highest DPD milestone reached.</li>
                    </ul>
                </div>
            </div>

            <!-- New Test Case 4 -->
            <div class="test-step">
                <h5>SIT-DUN-004: Automated Task Creation - DPD 90+</h5>
                
                <div class="test-results-section">
                    <h4>📝 Test Execution Results</h4>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Test Status</label>
                            <select class="status-dropdown" onchange="updateTestStatus('SIT-DUN-004', this.value)">
                                <option value="pending">Pending</option>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                                <option value="blocked">Blocked</option>
                                <option value="na">N/A</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Executed By</label>
                            <input type="text" placeholder="Tester name" data-testid="SIT-DUN-004" data-field="tester">
                        </div>
                        <div class="result-field">
                            <label>Execution Date</label>
                            <input type="date" data-testid="SIT-DUN-004" data-field="date">
                        </div>
                        <div class="result-field">
                            <label>Execution Time (minutes)</label>
                            <input type="number" placeholder="0" data-testid="SIT-DUN-004" data-field="duration">
                        </div>
                        <div class="result-field">
                            <label>Environment</label>
                            <select data-testid="SIT-DUN-004" data-field="environment">
                                <option value="">Select Environment</option>
                                <option value="dev">Development</option>
                                <option value="sit">SIT</option>
                                <option value="uat">UAT</option>
                                <option value="staging">Staging</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Build Version</label>
                            <input type="text" placeholder="v1.0.0" data-testid="SIT-DUN-004" data-field="build">
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field" style="grid-column: 1/-1;">
                            <label>Test Notes / Comments</label>
                            <textarea placeholder="Detailed test execution notes, observations, and comments..." data-testid="SIT-DUN-004" data-field="notes"></textarea>
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Defect ID (if failed)</label>
                            <input type="text" placeholder="DEF-018" data-testid="SIT-DUN-004" data-field="defect">
                        </div>
                        <div class="result-field">
                            <label>Retest Required</label>
                            <select data-testid="SIT-DUN-004" data-field="retest">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                                <option value="partial">Partial</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Priority</label>
                            <select data-testid="SIT-DUN-004" data-field="priority">
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="pre-conditions">
                    <strong>Pre-conditions:</strong>
                    <ul>
                        <li>Invoice records with DPD 90+ are present in Salesforce.</li>
                        <li>Automated task creation rule for DPD 90+ is active in Custom Metadata.</li>
                    </ul>
                </div>
                
                <div class="test-data">
                    <strong>Test Data:</strong>
                    <ul>
                        <li>Test invoice records with `Days_Past_Due__c` = 90, 120, 180.</li>
                    </ul>
                </div>
                
                <strong>Test Steps:</strong>
                <ol>
                    <li>Create or update invoice records in Salesforce to have `Days_Past_Due__c` >= 90.</li>
                    <li>Run the scheduled Apex job for dunning task automation.</li>
                    <li>Verify that a new Task record is created in Salesforce for each relevant invoice.</li>
                    <li>Check the Task details (Subject, Due Date, Assigned To, Comments) against CMDT configuration.</li>
                    <li>Verify task priority and assignment for highly overdue invoices.</li>
                </ol>
                
                <div class="expected-result">
                    <strong>Expected Results:</strong>
                    <ul>
                        <li>Tasks are created automatically for DPD 90+ invoices.</li>
                        <li>Task details and priority reflect the escalation for highly overdue accounts.</li>
                    </ul>
                </div>
            </div>

            <!-- New Test Case 5 (Error Handling for Dunning) -->
            <div class="test-step">
                <h5>SIT-DUN-005: Task Assignment and Notifications</h5>
                
                <div class="test-results-section">
                    <h4>📝 Test Execution Results</h4>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Test Status</label>
                            <select class="status-dropdown" onchange="updateTestStatus('SIT-DUN-005', this.value)">
                                <option value="pending">Pending</option>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                                <option value="blocked">Blocked</option>
                                <option value="na">N/A</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Executed By</label>
                            <input type="text" placeholder="Tester name" data-testid="SIT-DUN-005" data-field="tester">
                        </div>
                        <div class="result-field">
                            <label>Execution Date</label>
                            <input type="date" data-testid="SIT-DUN-005" data-field="date">
                        </div>
                        <div class="result-field">
                            <label>Execution Time (minutes)</label>
                            <input type="number" placeholder="0" data-testid="SIT-DUN-005" data-field="duration">
                        </div>
                        <div class="result-field">
                            <label>Environment</label>
                            <select data-testid="SIT-DUN-005" data-field="environment">
                                <option value="">Select Environment</option>
                                <option value="dev">Development</option>
                                <option value="sit">SIT</option>
                                <option value="uat">UAT</option>
                                <option value="staging">Staging</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Build Version</label>
                            <input type="text" placeholder="v1.0.0" data-testid="SIT-DUN-005" data-field="build">
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field" style="grid-column: 1/-1;">
                            <label>Test Notes / Comments</label>
                            <textarea placeholder="Detailed test execution notes, observations, and comments..." data-testid="SIT-DUN-005" data-field="notes"></textarea>
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Defect ID (if failed)</label>
                            <input type="text" placeholder="DEF-019" data-testid="SIT-DUN-005" data-field="defect">
                        </div>
                        <div class="result-field">
                            <label>Retest Required</label>
                            <select data-testid="SIT-DUN-005" data-field="retest">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                                <option value="partial">Partial</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Priority</label>
                            <select data-testid="SIT-DUN-005" data-field="priority">
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="pre-conditions">
                    <strong>Pre-conditions:</strong>
                    <ul>
                        <li>Automated task assignment rules are configured in Custom Metadata.</li>
                        <li>Email notification settings for new tasks are enabled.</li>
                    </ul>
                </div>
                
                <div class="test-data">
                    <strong>Test Data:</strong>
                    <ul>
                        <li>Invoice records triggering task creation with different assignment criteria.</li>
                        <li>Test users configured to receive task notifications.</li>
                    </ul>
                </div>
                
                <strong>Test Steps:</strong>
                <ol>
                    <li>Trigger automated task creation for various scenarios (e.g., different DPD levels, customer segments).</li>
                    <li>Verify that tasks are assigned to the correct users/queues based on CMDT rules.</li>
                    <li>Check that email notifications are sent to the assigned users/queues upon task creation.</li>
                    <li>Verify the content and links within the task notification emails.</li>
                    <li>Test scenarios where an assigned user is inactive or invalid.</li>
                </ol>
                
                <div class="expected-result">
                    <strong>Expected Results:</strong>
                    <ul>
                        <li>Tasks are assigned correctly according to business rules.</li>
                        <li>Assigned users receive timely and accurate email notifications.</li>
                        <li>System handles invalid assignments gracefully (e.g., reassigns to default, logs error).</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- Data Loader Scripts Tab -->
        <div id="data-loader" class="tab-content">
            <h2 class="section-header">Node.js Data Loader Scripts Test Scripts</h2>
            
            <div class="test-category">
                <h4>Test Category: Node.js Data Loader CLI Automation</h4>
                <p>Validates the functionality and robustness of the Node.js scripts for data processing</p>
            </div>
            
            <!-- Test Case 1 (Existing) -->
            <div class="test-step">
                <h5>SIT-DL-001: File Watcher & Conversion</h5>
                
                <div class="test-results-section">
                    <h4>📝 Test Execution Results</h4>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Test Status</label>
                            <select class="status-dropdown" onchange="updateTestStatus('SIT-DL-001', this.value)">
                                <option value="pending">Pending</option>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                                <option value="blocked">Blocked</option>
                                <option value="na">N/A</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Executed By</label>
                            <input type="text" placeholder="Tester name" data-testid="SIT-DL-001" data-field="tester">
                        </div>
                        <div class="result-field">
                            <label>Execution Date</label>
                            <input type="date" data-testid="SIT-DL-001" data-field="date">
                        </div>
                        <div class="result-field">
                            <label>Execution Time (minutes)</label>
                            <input type="number" placeholder="0" data-testid="SIT-DL-001" data-field="duration">
                        </div>
                        <div class="result-field">
                            <label>Environment</label>
                            <select data-testid="SIT-DL-001" data-field="environment">
                                <option value="">Select Environment</option>
                                <option value="dev">Development</option>
                                <option value="sit">SIT</option>
                                <option value="uat">UAT</option>
                                <option value="staging">Staging</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Build Version</label>
                            <input type="text" placeholder="v1.0.0" data-testid="SIT-DL-001" data-field="build">
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field" style="grid-column: 1/-1;">
                            <label>Test Notes / Comments</label>
                            <textarea placeholder="Detailed test execution notes, observations, and comments..." data-testid="SIT-DL-001" data-field="notes"></textarea>
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Defect ID (if failed)</label>
                            <input type="text" placeholder="DEF-006" data-testid="SIT-DL-001" data-field="defect">
                        </div>
                        <div class="result-field">
                            <label>Retest Required</label>
                            <select data-testid="SIT-DL-001" data-field="retest">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                                <option value="partial">Partial</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Priority</label>
                            <select data-testid="SIT-DL-001" data-field="priority">
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="pre-conditions">
                    <strong>Pre-conditions:</strong>
                    <ul>
                        <li>Node.js environment set up on WillScot server</li>
                        <li>File watcher script deployed and running</li>
                        <li>Test data files (e.g., ARCUST.txt) available</li>
                    </ul>
                </div>
                
                <strong>Test Steps:</strong>
                <ol>
                    <li>Place a new ARCUST.txt file in the designated monitoring folder</li>
                    <li>Verify the file watcher detects the new file</li>
                    <li>Verify the script converts the .txt file to .csv format</li>
                    <li>Check for correct header mapping in the generated .csv</li>
                    <li>Verify the original .txt file is moved to an "archive" or "processed" folder</li>
                </ol>
                
                <div class="expected-result">
                    <strong>Expected Results:</strong>
                    <ul>
                        <li>File watcher detects file within seconds</li>
                        <li>Correct .csv file generated with accurate data and headers</li>
                        <li>Original .txt file moved successfully</li>
                        <li>No errors logged in script console</li>
                    </ul>
                </div>
            </div>

            <!-- New Test Case 2 -->
            <div class="test-step">
                <h5>SIT-DL-002: Large Volume Data Load</h5>
                
                <div class="test-results-section">
                    <h4>📝 Test Execution Results</h4>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Test Status</label>
                            <select class="status-dropdown" onchange="updateTestStatus('SIT-DL-002', this.value)">
                                <option value="pending">Pending</option>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                                <option value="blocked">Blocked</option>
                                <option value="na">N/A</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Executed By</label>
                            <input type="text" placeholder="Tester name" data-testid="SIT-DL-002" data-field="tester">
                        </div>
                        <div class="result-field">
                            <label>Execution Date</label>
                            <input type="date" data-testid="SIT-DL-002" data-field="date">
                        </div>
                        <div class="result-field">
                            <label>Execution Time (minutes)</label>
                            <input type="number" placeholder="0" data-testid="SIT-DL-002" data-field="duration">
                        </div>
                        <div class="result-field">
                            <label>Environment</label>
                            <select data-testid="SIT-DL-002" data-field="environment">
                                <option value="">Select Environment</option>
                                <option value="dev">Development</option>
                                <option value="sit">SIT</option>
                                <option value="uat">UAT</option>
                                <option value="staging">Staging</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Build Version</label>
                            <input type="text" placeholder="v1.0.0" data-testid="SIT-DL-002" data-field="build">
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field" style="grid-column: 1/-1;">
                            <label>Test Notes / Comments</label>
                            <textarea placeholder="Detailed test execution notes, observations, and comments..." data-testid="SIT-DL-002" data-field="notes"></textarea>
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Defect ID (if failed)</label>
                            <input type="text" placeholder="DEF-007" data-testid="SIT-DL-002" data-field="defect">
                        </div>
                        <div class="result-field">
                            <label>Retest Required</label>
                            <select data-testid="SIT-DL-002" data-field="retest">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                                <option value="partial">Partial</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Priority</label>
                            <select data-testid="SIT-DL-002" data-field="priority">
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="pre-conditions">
                    <strong>Pre-conditions:</strong>
                    <ul>
                        <li>Node.js Data Loader CLI configured with Salesforce credentials</li>
                        <li>Salesforce API limits understood for bulk loads</li>
                    </ul>
                </div>
                
                <div class="test-data">
                    <strong>Test Data:</strong>
                    <ul>
                        <li>Large ARCUST.txt file (e.g., 50,000 records)</li>
                        <li>Large ARMAST.txt file (e.g., 100,000 records)</li>
                    </ul>
                </div>
                
                <strong>Test Steps:</strong>
                <ol>
                    <li>Prepare a large volume data file (e.g., ARCUST with 50,000 records).</li>
                    <li>Place the file in the monitoring folder.</li>
                    <li>Monitor the Data Loader CLI execution for performance and completion.</li>
                    <li>Verify all records are processed successfully in Salesforce.</li>
                    <li>Check Data Loader success/error logs for any issues.</li>
                    <li>Measure total processing time.</li>
                </ol>
                
                <div class="expected-result">
                    <strong>Expected Results:</strong>
                    <ul>
                        <li>All records from large files are successfully loaded into Salesforce.</li>
                        <li>Processing completes within acceptable performance thresholds.</li>
                        <li>No unexpected errors or timeouts occur during the bulk load.</li>
                        <li>Success logs confirm all records processed.</li>
                    </ul>
                </div>
            </div>

            <!-- New Test Case 3 (Error Handling for Data Loader) -->
            <div class="test-step">
                <h5>SIT-DL-003: Error Handling & Rejection File</h5>
                
                <div class="test-results-section">
                    <h4>📝 Test Execution Results</h4>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Test Status</label>
                            <select class="status-dropdown" onchange="updateTestStatus('SIT-DL-003', this.value)">
                                <option value="pending">Pending</option>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                                <option value="blocked">Blocked</option>
                                <option value="na">N/A</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Executed By</label>
                            <input type="text" placeholder="Tester name" data-testid="SIT-DL-003" data-field="tester">
                        </div>
                        <div class="result-field">
                            <label>Execution Date</label>
                            <input type="date" data-testid="SIT-DL-003" data-field="date">
                        </div>
                        <div class="result-field">
                            <label>Execution Time (minutes)</label>
                            <input type="number" placeholder="0" data-testid="SIT-DL-003" data-field="duration">
                        </div>
                        <div class="result-field">
                            <label>Environment</label>
                            <select data-testid="SIT-DL-003" data-field="environment">
                                <option value="">Select Environment</option>
                                <option value="dev">Development</option>
                                <option value="sit">SIT</option>
                                <option value="uat">UAT</option>
                                <option value="staging">Staging</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Build Version</label>
                            <input type="text" placeholder="v1.0.0" data-testid="SIT-DL-003" data-field="build">
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field" style="grid-column: 1/-1;">
                            <label>Test Notes / Comments</label>
                            <textarea placeholder="Detailed test execution notes, observations, and comments..." data-testid="SIT-DL-003" data-field="notes"></textarea>
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Defect ID (if failed)</label>
                            <input type="text" placeholder="DEF-008" data-testid="SIT-DL-003" data-field="defect">
                        </div>
                        <div class="result-field">
                            <label>Retest Required</label>
                            <select data-testid="SIT-DL-003" data-field="retest">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                                <option value="partial">Partial</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Priority</label>
                            <select data-testid="SIT-DL-003" data-field="priority">
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="pre-conditions">
                    <strong>Pre-conditions:</strong>
                    <ul>
                        <li>Data Loader CLI configured for error logging</li>
                        <li>Email notification system for errors configured</li>
                    </ul>
                </div>
                
                <div class="test-data">
                    <strong>Test Data:</strong>
                    <ul>
                        <li>ARCASH.txt with invalid customer IDs or duplicate records.</li>
                        <li>ARMAST.txt with missing required fields.</li>
                    </ul>
                </div>
                
                <strong>Test Steps:</strong>
                <ol>
                    <li>Prepare a data file with known invalid records (e.g., invalid customer ID in ARCASH).</li>
                    <li>Place the file in the monitoring folder.</li>
                    <li>Verify the Data Loader CLI processes valid records and rejects invalid ones.</li>
                    <li>Check that an `error.csv` file is generated with details of rejected records.</li>
                    <li>Verify an email notification is sent for the processing failure, including error details.</li>
                    <li>Confirm valid records were still processed successfully.</li>
                </ol>
                
                <div class="expected-result">
                    <strong>Expected Results:</strong>
                    <ul>
                        <li>Invalid records are rejected and detailed in `error.csv`.</li>
                        <li>Valid records in the same file are successfully processed.</li>
                        <li>Email notification with error summary is received.</li>
                        <li>System remains stable after processing files with errors.</li>
                    </ul>
                </div>
            </div>

            <!-- New Test Case 4 -->
            <div class="test-step">
                <h5>SIT-DL-004: Incremental Data Load</h5>
                
                <div class="test-results-section">
                    <h4>📝 Test Execution Results</h4>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Test Status</label>
                            <select class="status-dropdown" onchange="updateTestStatus('SIT-DL-004', this.value)">
                                <option value="pending">Pending</option>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                                <option value="blocked">Blocked</option>
                                <option value="na">N/A</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Executed By</label>
                            <input type="text" placeholder="Tester name" data-testid="SIT-DL-004" data-field="tester">
                        </div>
                        <div class="result-field">
                            <label>Execution Date</label>
                            <input type="date" data-testid="SIT-DL-004" data-field="date">
                        </div>
                        <div class="result-field">
                            <label>Execution Time (minutes)</label>
                            <input type="number" placeholder="0" data-testid="SIT-DL-004" data-field="duration">
                        </div>
                        <div class="result-field">
                            <label>Environment</label>
                            <select data-testid="SIT-DL-004" data-field="environment">
                                <option value="">Select Environment</option>
                                <option value="dev">Development</option>
                                <option value="sit">SIT</option>
                                <option value="uat">UAT</option>
                                <option value="staging">Staging</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Build Version</label>
                            <input type="text" placeholder="v1.0.0" data-testid="SIT-DL-004" data-field="build">
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field" style="grid-column: 1/-1;">
                            <label>Test Notes / Comments</label>
                            <textarea placeholder="Detailed test execution notes, observations, and comments..." data-testid="SIT-DL-004" data-field="notes"></textarea>
                        </div>
                    </div>
                    <div class="result-grid">
                        <div class="result-field">
                            <label>Defect ID (if failed)</label>
                            <input type="text" placeholder="DEF-009" data-testid="SIT-DL-004" data-field="defect">
                        </div>
                        <div class="result-field">
                            <label>Retest Required</label>
                            <select data-testid="SIT-DL-004" data-field="retest">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                                <option value="partial">Partial</option>
                            </select>
                        </div>
                        <div class="result-field">
                            <label>Priority</label>
                            <select data-testid="SIT-DL-004" data-field="priority">
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="pre-conditions">
                    <strong>Pre-conditions:</strong>
                    <ul>
                        <li>Initial data load completed for relevant objects (e.g., Accounts, Invoices)</li>
                        <li>Salesforce external IDs are correctly mapped for upsert operations</li>
                    </ul>
                </div>
                
                <div class="test-data">
                    <strong>Test Data:</strong>
                    <ul>
                        <li>Small ARCUST.txt or ARMAST.txt with updates to existing records and a few new records.</li>
                    </ul>
                </div>
                
                <strong>Test Steps:</strong>
                <ol>
                    <li>Load an initial set of customer/invoice data into Salesforce.</li>
                    <li>Prepare an incremental file with updates to some of the previously loaded records and a few new records.</li>
                    <li>Place the incremental file in the monitoring folder.</li>
                    <li>Verify the Data Loader CLI correctly identifies and updates existing records.</li>
                    <li>Verify new records are created successfully.</li>
                    <li>Check for any duplicate records or unintended data changes.</li>
                </ol>
                
                <div class="expected-result">
                    <strong>Expected Results:</strong>
                    <ul>
                        <li>Existing records are updated, and new records are created as expected.</li>
                        <li>No duplicate records are created.</li>
                        <li>Data integrity is maintained for all records.</li>
                        <li>Success logs reflect correct upsert counts.</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- Test Schedule Tab -->
        <div id="schedule" class="tab-content">
            <h2 class="section-header">SIT Test Schedule</h2>
            
            <div class="test-category">
                <h4>Test Category: Daily Execution Plan</h4>
                <p>This section outlines the daily schedule for System Integration Testing activities, including planned test cases, execution progress, and any daily notes. It serves as a living document to track the progress of the SIT phase.</p>
            </div>
            
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Planned Test Cases</th>
                            <th>Executed</th>
                            <th>Passed</th>
                            <th>Failed</th>
                            <th>Daily Notes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Aug 11, 2025</strong></td>
                            <td>SIT-SAP-001, SIT-SAP-002</td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-executed" data-date="aug11"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-passed" data-date="aug11"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-failed" data-date="aug11"></td>
                            <td><input type="text" placeholder="Daily notes..." class="daily-notes" data-date="aug11"></td>
                        </tr>
                        <tr>
                            <td><strong>Aug 12, 2025</strong></td>
                            <td>SIT-SAP-003, SIT-DL-001</td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-executed" data-date="aug12"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-passed" data-date="aug12"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-failed" data-date="aug12"></td>
                            <td><input type="text" placeholder="Daily notes..." class="daily-notes" data-date="aug12"></td>
                        </tr>
                        <tr>
                            <td><strong>Aug 13, 2025</strong></td>
                            <td>SIT-DL-002, SIT-DL-003</td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-executed" data-date="aug13"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-passed" data-date="aug13"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-failed" data-date="aug13"></td>
                            <td><input type="text" placeholder="Daily notes..." class="daily-notes" data-date="aug13"></td>
                        </tr>
                        <tr>
                            <td><strong>Aug 14, 2025</strong></td>
                            <td>SIT-DL-004, SIT-SAP-004</td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-executed" data-date="aug14"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-passed" data-date="aug14"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-failed" data-date="aug14"></td>
                            <td><input type="text" placeholder="Daily notes..." class="daily-notes" data-date="aug14"></td>
                        </tr>
                        <tr>
                            <td><strong>Aug 15, 2025</strong></td>
                            <td>SIT-MC-001, SIT-MC-002</td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-executed" data-date="aug15"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-passed" data-date="aug15"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-failed" data-date="aug15"></td>
                            <td><input type="text" placeholder="Daily notes..." class="daily-notes" data-date="aug15"></td>
                        </tr>
                        <tr>
                            <td><strong>Aug 18, 2025</strong></td>
                            <td>SIT-MC-003, SIT-MC-004</td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-executed" data-date="aug18"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-passed" data-date="aug18"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-failed" data-date="aug18"></td>
                            <td><input type="text" placeholder="Daily notes..." class="daily-notes" data-date="aug18"></td>
                        </tr>
                        <tr>
                            <td><strong>Aug 19, 2025</strong></td>
                            <td>SIT-MC-005, SIT-DUN-001</td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-executed" data-date="aug19"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-passed" data-date="aug19"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-failed" data-date="aug19"></td>
                            <td><input type="text" placeholder="Daily notes..." class="daily-notes" data-date="aug19"></td>
                        </tr>
                        <tr>
                            <td><strong>Aug 20, 2025</strong></td>
                            <td>SIT-DUN-002, SIT-DUN-003</td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-executed" data-date="aug20"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-passed" data-date="aug20"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-failed" data-date="aug20"></td>
                            <td><input type="text" placeholder="Daily notes..." class="daily-notes" data-date="aug20"></td>
                        </tr>
                        <tr>
                            <td><strong>Aug 21, 2025</strong></td>
                            <td>SIT-DUN-004, SIT-DUN-005</td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-executed" data-date="aug21"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-passed" data-date="aug21"></td>
                            <td><input type="number" min="0" max="2" value="0" class="daily-failed" data-date="aug21"></td>
                            <td><input type="text" placeholder="Daily notes..." class="daily-notes" data-date="aug21"></td>
                        </tr>
                        <tr>
                            <td><strong>Aug 22, 2025</strong></td>
                            <td>End-to-End Integration Testing</td>
                            <td><input type="number" min="0" max="5" value="0" class="daily-executed" data-date="aug22"></td>
                            <td><input type="number" min="0" max="5" value="0" class="daily-passed" data-date="aug22"></td>
                            <td><input type="number" min="0" max="5" value="0" class="daily-failed" data-date="aug22"></td>
                            <td><input type="text" placeholder="Daily notes..." class="daily-notes" data-date="aug22"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Export Format Modal -->
    <div id="exportFormatModal" class="export-format-modal">
        <div class="modal-content">
            <h3>Select Export Format</h3>
            <div class="format-options">
                <div class="format-option" data-format="csv">
                    <h4>CSV</h4>
                    <p>Comma-separated values</p>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeExportModal()">Cancel</button>
                <button class="btn btn-primary" onclick="exportResults()">Export</button>
            </div>
        </div>
    </div>

    <!-- Custom Message Box -->
    <div id="messageBox" style="display:none;"></div>
</body>
</html>
